<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.10">
<meta name="author" content="Alexander Kaloshin, Konstantin Pastor">
<title>Last.Backend. Reference Guide</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment @import statement to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite::before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
:not(pre)>code.nobreak{word-wrap:normal}
:not(pre)>code.nowrap{white-space:nowrap}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details>summary:first-of-type{cursor:pointer;display:list-item;outline:none;margin-bottom:.75em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class="highlight"],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos{border-right:1px solid currentColor;opacity:.35;padding-right:.5em}
pre.pygments .lineno{border-right:1px solid currentColor;opacity:.35;display:inline-block;margin-right:.75em}
pre.pygments .lineno::before{content:"";margin-right:-.125em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;text-align:left;margin-right:0}
table.tableblock{max-width:100%;border-collapse:separate}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
td.tableblock>.content>:last-child.sidebarblock{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot,table.frame-ends{border-width:1px 0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd),table.stripes-even tr:nth-of-type(even),table.stripes-hover tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>Last.Backend. Reference Guide</h1>
<div class="details">
<span id="author" class="author">Alexander Kaloshin, Konstantin Pastor</span><br>
<span id="revnumber">version latest,</span>
<span id="revdate">2019-09-21</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_overview">1. Overview</a>
<ul class="sectlevel2">
<li><a href="#_about_container_platform">1.1. About Container platform</a></li>
<li><a href="#_platform_structure">1.2. Platform structure:</a></li>
<li><a href="#_runtimes_overview">1.3. Runtimes overview</a></li>
<li><a href="#_endpoint_interface">1.4. Endpoint interface</a></li>
<li><a href="#_current_state">1.5. Current state</a></li>
</ul>
</li>
<li><a href="#_getting_started">2. Getting Started</a>
<ul class="sectlevel2">
<li><a href="#_ready_to_go_environment">2.1. Ready to go environment</a></li>
<li><a href="#_provision_personal_cluster">2.2. Provision personal cluster</a></li>
</ul>
</li>
<li><a href="#_installation">3. Installation</a>
<ul class="sectlevel2">
<li><a href="#_components">3.1. Components</a>
<ul class="sectlevel3">
<li><a href="#_rest_api">3.1.1. REST API</a></li>
<li><a href="#_controller">3.1.2. Controller</a></li>
<li><a href="#_node">3.1.3. Node</a></li>
<li><a href="#_discovery">3.1.4. Discovery</a></li>
<li><a href="#_ingress">3.1.5. Ingress</a></li>
<li><a href="#_ingress_2">3.1.6. Ingress</a></li>
</ul>
</li>
<li><a href="#_development_installation">3.2. Development Installation</a></li>
<li><a href="#_local_installation">3.3. Local Installation</a></li>
<li><a href="#_self_hosted_installation">3.4. Self-Hosted Installation</a></li>
<li><a href="#_last_backend_hosted_installation">3.5. Last.Backend Hosted Installation</a></li>
<li><a href="#_provider_hosted_installation">3.6. Provider Hosted Installation</a></li>
</ul>
</li>
<li><a href="#_design_manifest">4. Design manifest</a>
<ul class="sectlevel2">
<li><a href="#_overview_2">4.1. Overview</a></li>
<li><a href="#_manifests">4.2. Manifests</a></li>
<li><a href="#_processes">4.3. Processes</a></li>
<li><a href="#_storage">4.4. Storage</a></li>
</ul>
</li>
<li><a href="#_network_design">5. Network Design</a>
<ul class="sectlevel2">
<li><a href="#_network_runtime">5.1. Network Runtime</a></li>
<li><a href="#_cni">5.2. CNI</a></li>
<li><a href="#_cpi">5.3. CPI</a></li>
</ul>
</li>
<li><a href="#_last_backend_runtime">6. Last.Backend Runtime</a>
<ul class="sectlevel2">
<li><a href="#_namespace_runtime">6.1. Namespace runtime</a>
<ul class="sectlevel3">
<li><a href="#_namespace">6.1.1. Namespace</a></li>
<li><a href="#_service">6.1.2. Service</a></li>
<li><a href="#_deployment">6.1.3. Deployment</a></li>
<li><a href="#_pod">6.1.4. Pod</a></li>
<li><a href="#_endpoint">6.1.5. Endpoint</a></li>
<li><a href="#_volumes">6.1.6. Volumes</a></li>
<li><a href="#_secret">6.1.7. Secret</a></li>
<li><a href="#_config">6.1.8. Config</a></li>
<li><a href="#_routes">6.1.9. Routes</a></li>
</ul>
</li>
<li><a href="#_cluster_runtime">6.2. Cluster runtime</a></li>
</ul>
</li>
<li><a href="#_database">7. Database</a>
<ul class="sectlevel2">
<li><a href="#_interface">7.1. Interface</a></li>
<li><a href="#_mock">7.2. Mock</a></li>
<li><a href="#_etcd_v3">7.3. ETCD v3</a></li>
</ul>
</li>
<li><a href="#_contributing">8. Contributing</a>
<ul class="sectlevel2">
<li><a href="#_how_to_contribute">8.1. How to Contribute</a>
<ul class="sectlevel3">
<li><a href="#_how_to_contribute_to_open_source_on_github">8.1.1. How to contribute to open source on GitHub</a></li>
<li><a href="#_benefits_for_active_contributors">8.1.2. Benefits for active contributors</a></li>
<li><a href="#_coding_style">8.1.3. Coding Style</a></li>
<li><a href="#_reporting_issues">8.1.4. Reporting issues</a></li>
</ul>
</li>
<li><a href="#_the_roadmap">8.2. The Roadmap</a></li>
<li><a href="#_support">8.3. Support</a></li>
<li><a href="#_documentation">8.4. Documentation</a></li>
</ul>
</li>
<li><a href="#_license">Appendix A: License</a></li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This reference for version: <em>latest</em></p>
</div>
<div class="paragraph">
<p><span class="image"><img src="assets/preview.png" alt="Last.Backend"></span></p>
</div>
<div class="paragraph">
<p><strong>Last.Backend container management platform is the new and modern open-source container management system with service discovery, overlay networks and more..</strong></p>
</div>
<div class="paragraph">
<p>Source code available at <a href="https://github.com/lastbackend/lastbackend">lastbackend/lastbackend</a> GitHub repository.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_overview"><a class="anchor" href="#_overview"></a>1. Overview</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Last.Backend is an open source platform for containerized application management on all stages: from deploy to scale.
This solution is based on container technology and fully support docker containers type.</p>
</div>
<div class="paragraph">
<p>Note that project is under active development and our team is working day and night to make it better.
Your suggestions, comments and contributions is very helpful. Big thanks for that!</p>
</div>
<div class="sect2">
<h3 id="_about_container_platform"><a class="anchor" href="#_about_container_platform"></a>1.1. About Container platform</h3>
<div class="paragraph">
<p>Container platform is an open-source system for automating deployment, scaling, and management of containerized applications.
It contains a set of technologies like: container scheduling, service discovery, overlay network, container runtime, container images runtime, load-balancing and more.
All these technologies are provided out of the box and don&#8217;t requiring additional research and setup.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="assets/structure.png" alt="Last.Backend Structure"></span></p>
</div>
</div>
<div class="sect2">
<h3 id="_platform_structure"><a class="anchor" href="#_platform_structure"></a>1.2. Platform structure:</h3>
<div class="ulist">
<ul>
<li>
<p>REST API server.
Entrypoint for cluster management.</p>
</li>
<li>
<p>State controller.
Cluster state watcher. Performs all operation for pod creating and manage entities lifecycle.</p>
</li>
<li>
<p>Resources Scheduler.
Resources scheduler operates with cluster resources. It handles all resources utilization requests and manages entities spreading across cluster.</p>
</li>
<li>
<p>Node agent.
Node agent is process that operates with host. It creates pods, endpoint, networks, load-balancers and other entities.</p>
</li>
<li>
<p>Service discovery.
Service discovery is internal DNS server. It manages services IPs with internal domain names.</p>
</li>
<li>
<p>Ingress proxy.
Proxy server, based on self-configurable HAproxy. Manages External traffic from WEB to internal overlay network.</p>
</li>
<li>
<p>Log collector.
Log collector stores and aggregates logs from whole cluster. It can export logs to external database for additional analytic and search.</p>
</li>
<li>
<p>IPVS-based load-balancer.
Load-Balancer that provides traffic management across pods in cluster.</p>
</li>
<li>
<p>VxLAN-based overlay network
Overlay network connects all docker hosts into one big overlay network, where pods from different nodes can access each other.</p>
</li>
<li>
<p>Storage runtime driver
Driver implements persistent storage for pods. It adds ability to deploy stateful services.</p>
</li>
<li>
<p>Container runtime
Container runtime is responsible to manage containers in host. Docker runtime driver is used by default.</p>
</li>
<li>
<p>Container images runtime
Container runtime is responsible to manage container images in host. Docker container images driver is used by default.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_runtimes_overview"><a class="anchor" href="#_runtimes_overview"></a>1.3. Runtimes overview</h3>
<div class="paragraph">
<p>Last.Backend runtime design allows us to create extendable system. We separated runtime into particular packages.</p>
</div>
<div class="paragraph">
<p>By default Last.Backend is provided with these runtimes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>CRI - container runtime interface: docker by default</p>
</li>
<li>
<p>CII - container image interface: docker by default</p>
</li>
<li>
<p>CSI - container storage interface: host directory by default</p>
</li>
<li>
<p>CNI - container network interface: vxlan by default</p>
</li>
<li>
<p>CPI - container proxy interface: IPVS by default</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>All these runtimes are documented in runtime section. where all methods, types and algorithms are described.</p>
</div>
</div>
<div class="sect2">
<h3 id="_endpoint_interface"><a class="anchor" href="#_endpoint_interface"></a>1.4. Endpoint interface</h3>
<div class="paragraph">
<p>The main endpoint to manage cluster is REST API interface.
Our team uses swagger as API documentation generator. To create swagger spec, just execute <code>` make swagger-spec</code>` command in root of repository.</p>
</div>
<div class="paragraph">
<p>You can use REST API in these options:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Directly with CURL or another apps</p>
</li>
<li>
<p>Using Last.Backend CLI located in separate repo lastbackend/cli[<a href="https://github.com/lastbackend/cli" class="bare">https://github.com/lastbackend/cli</a>]</p>
</li>
<li>
<p>Using golang package, located in <code>pgk/api/client</code>. For building custom go apps as example.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_current_state"><a class="anchor" href="#_current_state"></a>1.5. Current state</h3>
<div class="paragraph">
<p>Current version is in public beta stage and includes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>cluster management</p>
</li>
<li>
<p>node management</p>
</li>
<li>
<p>overlay network based on vxlan</p>
</li>
<li>
<p>internal endpoints for pods balancing based on IPVS</p>
</li>
<li>
<p>ingress server based on haproxy</p>
</li>
<li>
<p>internal discovery server</p>
</li>
<li>
<p>services management with basic blue/green deployments</p>
</li>
<li>
<p>volumes management</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_getting_started"><a class="anchor" href="#_getting_started"></a>2. Getting Started</h2>
<div class="sectionbody">
<div class="paragraph">
<p>There is multiple ways you can use to start with Last.Backend:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Obtain resources with public Last.Backend clusters.</p>
</li>
<li>
<p>Obtain dedicated cluster from Last.Backend.</p>
</li>
<li>
<p>Deploy your own Last.Backend cluster and connect it to <strong>control-panel</strong></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_ready_to_go_environment"><a class="anchor" href="#_ready_to_go_environment"></a>2.1. Ready to go environment</h3>
<div class="paragraph">
<p>Ready-to-go environment is available on <a href="https://app.lastbackend.com" class="bare">https://app.lastbackend.com</a> control panel for your experiments.
In our control plane you can create new cluster, or connect existing cluster.</p>
</div>
<div class="paragraph">
<p>There are several types of management for cluster connected to control panel:
- WEB UI
- CLI</p>
</div>
<div class="paragraph">
<p>Using this panel you can manage multiple clusters located on defferent hosting providers from single point.</p>
</div>
</div>
<div class="sect2">
<h3 id="_provision_personal_cluster"><a class="anchor" href="#_provision_personal_cluster"></a>2.2. Provision personal cluster</h3>
<div class="paragraph">
<p>There are many options how you can get local last.backend cluster.
The most popular are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>local version with docker-machine
You can easily create local environment with docker-machine.
You can create local cluster contains 1 node or multiple nodes, with full fuctional support.
This is a good point to start testing, or start contributing.</p>
</li>
<li>
<p>hosted version, provisioned with ansible
Our team prepared ansible roles for deploy last.backend cluster on your favourite environment.
Ansible roles located at separated repository <a href="https://github.com/lastbackend/ansible" class="bare">https://github.com/lastbackend/ansible</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_installation"><a class="anchor" href="#_installation"></a>3. Installation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In this section you can find the best solution for setup Last.Backend cluster.</p>
</div>
<div class="paragraph">
<p>You can run Last.Backend cluster almost anywhere. You can start from your laptop or VMs on a cloud provider.
Your decision should be based on available resources and infrastructure design requirements.</p>
</div>
<div class="sect2">
<h3 id="_components"><a class="anchor" href="#_components"></a>3.1. Components</h3>
<div class="paragraph">
<p>Last.Backend container cluster contains 6 components:
- REST API
- Controller
- Node
- Ingress
- Discovery
- Exporter</p>
</div>
<div class="sect3">
<h4 id="_rest_api"><a class="anchor" href="#_rest_api"></a>3.1.1. REST API</h4>
<div class="paragraph">
<p>REST API component is the control point to manage Last.Backend cluster.
It validates and configures data for the api objects which include pods, services, deployments, routes, and others.</p>
</div>
<div class="paragraph">
<p>REST API is distributed as docker image, located at: <code>index.lstbknd.net/lastbackend/lastbackend</code></p>
</div>
<div class="paragraph">
<p>To run REST API server you can use this command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">docker run -it -d --name=api index.lstbknd.net/lastbackend/lastbackend api [options]</code></pre>
</div>
</div>
<div class="paragraph">
<p>The available options:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Table Options</caption>
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Environment</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--access-token</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_ACCESS_TOKEN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Access token to API server</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--cluster-name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_CLUSTER_NAME</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cluster name info</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--cluster-description</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_CLUSTER_DESCRIPTION</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cluster description</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--bind-address</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_BIND_ADDRESS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.0.0.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Bind address for listening</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--tls-cert-file</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_TLS_CERT_FILE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TLS cert file path</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--tls-private-key-file</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_TLS_PRIVATE_KEY</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TLS private key file path</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--tls-ca-file</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_TLS_CA_FILE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TLS certificate authority file path</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--vault-token</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_VAULT_TOKEN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vault access token</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--vault-endpoint</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_VAULT_ENDPOINT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://api.lastbackend.com" class="bare">https://api.lastbackend.com</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vault access endpoint</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--domain-internal</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_DOMAIN_INTERNAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">lb.local</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Internal domain name for cluster</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--domain-external</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_DOMAIN_EXTERNAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default external domain for cluster</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--storage</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_STORAGE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">etcd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Set storage driver (Allow: etcd, mock)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--etcd-cert-file</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_ETCD_CERT_FILE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ETCD database cert file path</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--etcd-private-key-file</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_ETCD_PRIVATE_KEY_FILE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ETCD database private key file path</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--etcd-ca-file</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_ETCD_CA_FILE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ETCD database certificate authority file</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--etcd-endpoints</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_ETCD_ENDPOINTS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">slice of string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">127.0.0.1:2379</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ETCD database endpoints list</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--etcd-prefix</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_ETCD_PREFIX</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">lastbackend</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ETCD database storage prefix</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--verbose, -v</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_VERBOSE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Set log level from 0 to 7</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--config, -c</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_CONFIG</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Path for the configuration file</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--help, -h</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Print usage</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Or you can use config file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="comment">#</span>
<span class="comment"># Last.Backend LLC CONFIDENTIAL</span>
<span class="comment"># _____________________________</span>
<span class="comment">#</span>
<span class="comment"># [2014] - [2019] Last.Backend LLC</span>
<span class="comment"># All Rights Reserved.</span>
<span class="comment">#</span>
<span class="comment"># NOTICE:  All information contained herein is, and remains</span>
<span class="comment"># the property of Last.Backend LLC and its suppliers,</span>
<span class="comment"># if any.  The intellectual and technical concepts contained</span>
<span class="comment"># herein are proprietary to Last.Backend LLC</span>
<span class="comment"># and its suppliers and may be covered by Russian Federation and Foreign Patents,</span>
<span class="comment"># patents in process, and are protected by trade secret or copyright law.</span>
<span class="comment"># Dissemination of this information or reproduction of this material</span>
<span class="comment"># is strictly forbidden unless prior written permission is obtained</span>
<span class="comment"># from Last.Backend LLC.</span>
<span class="comment">#</span>
<span class="comment">#</span>
<span class="comment"># ===============================================================================</span>
<span class="comment"># REST API config settings ======================================================</span>
<span class="comment"># ===============================================================================</span>

<span class="comment"># Log level [0-7]</span>
<span class="key">verbose</span>: <span class="string"><span class="content">integer</span></span>
<span class="comment"># Authentication token</span>
<span class="comment"># Usages:</span>
<span class="comment">#   As header: Authorization Bearer &lt;token&gt;</span>
<span class="comment">#   As querystring parameter: x-lastabckend=&lt;token&gt;</span>
<span class="key">token</span>: <span class="string"><span class="content">string</span></span>


<span class="comment"># Cluster name</span>
<span class="key">name</span>: <span class="string"><span class="content">string</span></span>
<span class="comment"># Cluster description</span>
<span class="key">description</span>: <span class="string"><span class="content">string</span></span>


<span class="comment"># System domains settings</span>
<span class="comment"># Cluster domains configuration</span>
<span class="key">domain</span>:
  <span class="comment"># Internal cluster domain for intercluster communication</span>
  <span class="key">internal</span>: <span class="string"><span class="content">string</span></span>
  <span class="comment"># External cluster domain for ingress routes</span>
  <span class="key">external</span>: <span class="string"><span class="content">string</span></span>


<span class="comment"># Storage settings</span>
<span class="key">storage</span>:
  <span class="comment"># Storage driver type (Only: etcd)</span>
  <span class="key">driver</span>: <span class="string"><span class="content">string</span></span>
  <span class="comment"># Etcd storage driver</span>
  <span class="key">etcd</span>:
    <span class="comment"># Last.Backend cluster database prefix</span>
    <span class="key">prefix</span>: <span class="string"><span class="content">string</span></span>
    <span class="comment"># ETCD endpoints list</span>
    <span class="key">endpoints</span>: <span class="string"><span class="content">[string]</span></span>
  <span class="comment"># Etcd authentication TLS settings</span>
  <span class="key">tls</span>:
    <span class="comment"># TLS certificate file path</span>
    <span class="key">cert</span>: <span class="string"><span class="content">string</span></span>
    <span class="comment"># TLS private key file path</span>
    <span class="key">key</span>: <span class="string"><span class="content">string</span></span>
    <span class="comment"># TLS certificate authority file path</span>
    <span class="key">ca</span>: <span class="string"><span class="content">string</span></span>


<span class="comment"># Cluster http-server settings</span>
<span class="key">server</span>:
  <span class="comment"># REST API server listen address (0.0.0.0 by default)</span>
  <span class="key">host</span>: <span class="string"><span class="content">string</span></span>
  <span class="comment"># REST API server port listen option (2967 by defaul)</span>
  <span class="key">port</span>: <span class="string"><span class="content">integer</span></span>
  <span class="comment"># Https/tls configurations</span>
  <span class="key">tls</span>:
<span class="error">        </span>  <span class="comment"># TLS certificate file path</span>
<span class="error">        </span>  <span class="key">cert</span>: <span class="string"><span class="content">string</span></span>
<span class="error">        </span>  <span class="comment"># TLS private key file path</span>
<span class="error">        </span>  <span class="key">key</span>: <span class="string"><span class="content">string</span></span>
<span class="error">        </span>  <span class="comment"># TLS certificate authority file path</span>
<span class="error">        </span>  <span class="key">ca</span>: <span class="string"><span class="content">string</span></span>


<span class="comment"># Last.Backend vault service settings</span>
<span class="key">vault</span>:
  <span class="comment"># Last.Backend Vault endpoint</span>
  <span class="key">endpoint</span>: <span class="string"><span class="content">string</span></span>
  <span class="comment"># Last.Backend Vault authentication token</span>
  <span class="key">token</span>: <span class="string"><span class="content">string</span></span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_controller"><a class="anchor" href="#_controller"></a>3.1.2. Controller</h4>
<div class="paragraph">
<p>Controller component is the main cluster state management component.</p>
</div>
<div class="paragraph">
<p>Controller is a service that embeds the core control loops and handle all cluster state. The Controller&#8217;s control loop watches the shared state of the cluster through the storage and makes changes attempting to move the current state towards the desired state.</p>
</div>
<div class="paragraph">
<p>Controller is distributed as docker image, located at: <code>index.lstbknd.net/lastbackend/lastbackend</code></p>
</div>
<div class="paragraph">
<p>To run controller service you can use this command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">docker run -it -d --name=api index.lstbknd.net/lastbackend/lastbackend controller [options]</code></pre>
</div>
</div>
<div class="paragraph">
<p>The available options:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 2. Table Options</caption>
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Environment</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--services-cidr</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_SERVICES_CIDR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">172.0.0.0/24</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Services IP CIDR for internal IPAM service</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--storage</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_STORAGE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">etcd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Set storage driver (Allow: etcd, mock)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--etcd-cert-file</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_ETCD_CERT_FILE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ETCD database cert file path</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--etcd-private-key-file</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_ETCD_PRIVATE_KEY_FILE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ETCD database private key file path</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--etcd-ca-file</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_ETCD_CA_FILE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ETCD database certificate authority file</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--etcd-endpoints</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_ETCD_ENDPOINTS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">slice of string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">127.0.0.1:2379</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ETCD database endpoints list</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--etcd-prefix</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_ETCD_PREFIX</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">lastbackend</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ETCD database storage prefix</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--verbose, -v</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_VERBOSE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Set log level from 0 to 7</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--config, -c</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_CONFIG</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Path for the configuration file</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--help, -h</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Print usage</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Or you can use config file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="head"><span class="head">---</span></span>
<span class="comment">#</span>
<span class="comment"># Last.Backend LLC CONFIDENTIAL</span>
<span class="comment"># _____________________________</span>
<span class="comment">#</span>
<span class="comment"># [2014] - [2019] Last.Backend LLC</span>
<span class="comment"># All Rights Reserved.</span>
<span class="comment">#</span>
<span class="comment"># NOTICE:  All information contained herein is, and remains</span>
<span class="comment"># the property of Last.Backend LLC and its suppliers,</span>
<span class="comment"># if any.  The intellectual and technical concepts contained</span>
<span class="comment"># herein are proprietary to Last.Backend LLC</span>
<span class="comment"># and its suppliers and may be covered by Russian Federation and Foreign Patents,</span>
<span class="comment"># patents in process, and are protected by trade secret or copyright law.</span>
<span class="comment"># Dissemination of this information or reproduction of this material</span>
<span class="comment"># is strictly forbidden unless prior written permission is obtained</span>
<span class="comment"># from Last.Backend LLC.</span>
<span class="comment">#</span>
<span class="comment">#</span>
<span class="comment"># ===============================================================================</span>
<span class="comment"># Controller config settings ====================================================</span>
<span class="comment"># ===============================================================================</span>

<span class="comment"># Log level [0-7]</span>
<span class="key">verbose</span>: <span class="string"><span class="content">integer</span></span>

<span class="comment"># Storage settings</span>
<span class="key">storage</span>:
  <span class="comment"># Storage driver type (Only: etcd)</span>
  <span class="key">driver</span>: <span class="string"><span class="content">string</span></span>
  <span class="comment"># Etcd storage driver</span>
  <span class="key">etcd</span>:
    <span class="comment"># Last.Backend cluster database prefix</span>
    <span class="key">prefix</span>: <span class="string"><span class="content">string</span></span>
    <span class="comment"># ETCD endpoints list</span>
    <span class="key">endpoints</span>: <span class="string"><span class="content">[string]</span></span>
  <span class="comment"># Etcd authentication TLS settings</span>
  <span class="key">tls</span>:
    <span class="comment"># TLS certificate file path</span>
    <span class="key">cert</span>: <span class="string"><span class="content">string</span></span>
    <span class="comment"># TLS private key file path</span>
    <span class="key">key</span>: <span class="string"><span class="content">string</span></span>
    <span class="comment"># TLS certificate authority file path</span>
    <span class="key">ca</span>: <span class="string"><span class="content">string</span></span>


<span class="key">service</span>:
  <span class="comment"># Services internal IPAM CIDR</span>
  <span class="key">cidr</span>: <span class="string"><span class="content">string</span></span> <span class="comment">#172.0.0.0/24 by default</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_node"><a class="anchor" href="#_node"></a>3.1.3. Node</h4>
<div class="paragraph">
<p>Node component is the control point to manage Last.Backend cluster.
It validates and configures data for the api objects which include pods, services, deployments, routes, and others.</p>
</div>
<div class="paragraph">
<p>REST API is distributed as docker image, located at: <code>index.lstbknd.net/lastbackend/lastbackend</code></p>
</div>
<div class="paragraph">
<p>To run REST API server you can use this command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">docker run -it -d --name=api index.lstbknd.net/lastbackend/lastbackend node [options]</code></pre>
</div>
</div>
<div class="paragraph">
<p>The available options:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 3. Table Options</caption>
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Environment</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--access-token</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_ACCESS_TOKEN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Access token to API server</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--workdir</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_NODE_WORKDIR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Node workdir for runtime</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--manifest-path</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_NODE_MANIFESTS_PATH</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Node manifest(s) path</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--bind-interface</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_NODE_BIND_INTERFACE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">eth0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Node bind external network interface to access internal connections</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--network-proxy</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_NETWORK_PROXY</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ipvs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Network proxy driver (ipvs by default)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--network-proxy-iface-internal</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_NETWORK_PROXY_IFACE_INTERNAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">docker0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Network proxy internal interface binding</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--network-proxy-iface-external</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_NETWORK_PROXY_IFACE_EXTERNAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">eth0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Network proxy external interface binding</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--network-driver</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_NETWORK_DRIVER</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vxlan</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Network driver (vxlan by default)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--network-driver-iface-external</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_NETWORK_DRIVER_IFACE_EXTERNAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">eth0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Container overlay network external interface for host communication</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--network-driver-iface-internal</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_NETWORK_DRIVER_IFACE_INTERNAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">docker0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Container overlay network internal bridge interface for container intercommunications</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--container-runtime</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_CONTAINER_RUNTIME</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">docker</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Node container runtime</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--container-runtime-docker-version</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_RUNTIME_DOCKER_VERSION</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Set docker version for docker container runtime</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--container-storage-root</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_CONTAINER_STORAGE_ROOT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/var/run/lastbackend</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Node container storage root for pod volumes and persistent volumes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--container-image-runtime</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_CONTAINER_IMAGE_RUNTIME</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">docker</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Node container images runtime</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--bind-address</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_NODE_BIND_ADDRESS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.0.0.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Node bind address</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--bind-port</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_NODE_BIND_PORT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2965</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Node listening port binding</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--tls-cert-file</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_NODE_TLS_CERT_FILE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Node cert file path</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--tls-private-key-file</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_NODE_PRIVATE_KEY_FILE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Node private key file path</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--tls-ca-file</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_NODE_CA_FILE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Node certificate authority file path</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--api-uri</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_API_URI</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">REST API endpoint</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--api-tls-cert-file</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_API_CERT_FILE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">REST API TLS certificate file path</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--api-tls-private-key-file</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_API_PRIVATE_KEY_FILE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">REST API TLS private key file path</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--api-tls-ca-file</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_API_CA_FILE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">REST API TSL certificate authority file path</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--verbose, -v</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_VERBOSE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Set log level from 0 to 7</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--config, -c</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_CONFIG</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Path for the configuration file</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--help, -h</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Print usage</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Or you can use config file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="head"><span class="head">---</span></span>
<span class="comment">#</span>
<span class="comment"># Last.Backend LLC CONFIDENTIAL</span>
<span class="comment"># _____________________________</span>
<span class="comment">#</span>
<span class="comment"># [2014] - [2019] Last.Backend LLC</span>
<span class="comment"># All Rights Reserved.</span>
<span class="comment">#</span>
<span class="comment"># NOTICE:  All information contained herein is, and remains</span>
<span class="comment"># the property of Last.Backend LLC and its suppliers,</span>
<span class="comment"># if any.  The intellectual and technical concepts contained</span>
<span class="comment"># herein are proprietary to Last.Backend LLC</span>
<span class="comment"># and its suppliers and may be covered by Russian Federation and Foreign Patents,</span>
<span class="comment"># patents in process, and are protected by trade secret or copyright law.</span>
<span class="comment"># Dissemination of this information or reproduction of this material</span>
<span class="comment"># is strictly forbidden unless prior written permission is obtained</span>
<span class="comment"># from Last.Backend LLC.</span>
<span class="comment">#</span>
<span class="comment">#</span>
<span class="comment"># ===============================================================================</span>
<span class="comment"># Node config settings ==========================================================</span>
<span class="comment"># ===============================================================================</span>

<span class="comment"># Log level [0-7]</span>
<span class="key">verbose</span>: <span class="string"><span class="content">integer</span></span>
<span class="comment"># Authentication token</span>
<span class="comment"># Usages:</span>
<span class="comment">#   As header: Authorization Bearer &lt;token&gt;</span>
<span class="comment">#   As querystring parameter: x-lastabckend=&lt;token&gt;</span>
<span class="key">token</span>: <span class="string"><span class="content">string</span></span>
<span class="comment"># Node default workdir for system files</span>
<span class="key">workdir</span>: <span class="string"><span class="content">string</span></span>

<span class="comment"># Local node manifest options. Use local manifests if you need local binded containers or deployments.</span>
<span class="key">manifest</span>:
  <span class="comment"># Manifest local directory</span>
  <span class="key">dir</span>: <span class="string"><span class="content">string</span></span>


<span class="comment"># Network settings</span>
<span class="key">network</span>:
<span class="error">        </span><span class="comment"># External interface for listening worldwide</span>
<span class="error">        </span><span class="key">interface</span>: <span class="string"><span class="content">string</span><span class="content">
  # Container proxy interface
  cpi:
    # Network proxy driver (ipvs by default)
    type: string
    # proxy network interface bindings
    interface:
      # external network interface for proxy
      external:
      # internal network interface for proxy
      internal:
  # Container network interface options
  cni:
    # Container overlay network driver (vxlan by default)
    type: string</span></span>
<span class="error">        </span><span class="error">        </span><span class="comment"># overlay network interfaces bindigs</span>
<span class="error">        </span><span class="error">        </span><span class="key">iterface</span>:
<span class="error">        </span><span class="error">        </span><span class="error">        </span><span class="comment"># External network interface for network building</span>
<span class="error">        </span><span class="error">        </span><span class="error">        </span><span class="key">external</span>: <span class="string"><span class="content">string</span></span>
<span class="error">        </span><span class="error">        </span><span class="error">        </span><span class="comment"># Internal bridge network interface for network building</span>
<span class="error">        </span><span class="error">        </span><span class="error">        </span><span class="key">internal</span>: <span class="string"><span class="content">string</span></span>

<span class="comment"># Container interfaces</span>
<span class="key">container</span>:
  <span class="comment"># Container runtime interface</span>
  <span class="key">cri</span>:
    <span class="comment"># Container runtime driver (docker by default)</span>
    <span class="key">type</span>: <span class="string"><span class="content">string</span></span>
    <span class="comment"># Docker driver configuration</span>
    <span class="key">docker</span>:
      <span class="comment">#        Optional specify particular docker version</span>
      <span class="key">version</span>: <span class="string"><span class="content">string</span></span>
  <span class="comment"># Storage runtime interface</span>
  <span class="key">csi</span>:
    <span class="comment"># Container storage - directory options</span>
    <span class="key">dir</span>:
      <span class="comment"># Directiry path</span>
      <span class="key">root</span>: <span class="string"><span class="content">string</span></span>
  <span class="comment"># Container images runtime interface</span>
  <span class="key">iri</span>:
    <span class="comment"># Container images driver (docker by default)</span>
    <span class="key">type</span>: <span class="string"><span class="content">string</span></span>
    <span class="comment"># Docker driver configuration</span>
    <span class="key">docker</span>:
      <span class="comment"># Optional specify particular docker version</span>
      <span class="key">version</span>: <span class="string"><span class="content">string</span></span>

<span class="comment"># Cluster node http-server settings</span>
<span class="key">server</span>:
  <span class="comment"># Node API server listen address (0.0.0.0 by default)</span>
  <span class="key">host</span>: <span class="string"><span class="content">string</span></span>
  <span class="comment"># Node API server port listen option (2969 by defaul)</span>
  <span class="key">port</span>: <span class="string"><span class="content">integer</span></span>
  <span class="comment"># Https/tls configurations</span>
  <span class="key">tls</span>:
<span class="error">        </span>  <span class="comment"># TLS certificate file path</span>
<span class="error">        </span>  <span class="key">cert</span>: <span class="string"><span class="content">string</span></span>
<span class="error">        </span>  <span class="comment"># TLS private key file path</span>
<span class="error">        </span>  <span class="key">key</span>: <span class="string"><span class="content">string</span></span>
<span class="error">        </span>  <span class="comment"># TLS certificate authority file path</span>
<span class="error">        </span>  <span class="key">ca</span>: <span class="string"><span class="content">string</span></span>


<span class="comment"># REST API client options</span>
<span class="key">api</span>:
  <span class="comment"># REST API Endpoint (http://127.0.0.1)</span>
  <span class="key">uri</span>: <span class="string"><span class="content">string</span></span>
  <span class="comment"># REST API TLS options</span>
  <span class="key">tls</span>:
    <span class="comment"># REST API TLS client certificate file path</span>
    <span class="key">cert</span>: <span class="string"><span class="content">string</span></span>
    <span class="comment"># REST API TLS private key file path</span>
    <span class="key">key</span>: <span class="string"><span class="content">string</span></span>
    <span class="comment"># REST API TLS client certificate authority file path</span>
    <span class="key">ca</span>: <span class="string"><span class="content">string</span></span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_discovery"><a class="anchor" href="#_discovery"></a>3.1.4. Discovery</h4>
<div class="paragraph">
<p>Discovery service controll services accessibility with their DNS names.
It works with internal IPAM datastore and responce service internal IP to requested resource.</p>
</div>
<div class="paragraph">
<p>Discovery service work with Last.Backend API server to register itself in platform and with internal storage to retrieve DNS information.
It has built in cache for performance optimization. You don&#8217;t need to flush cache, because discovery service subscribed to storage data changing events.</p>
</div>
<div class="paragraph">
<p>Discovery service is distributed with docker image, located at: <code>index.lstbknd.net/lastbackend/discovery</code></p>
</div>
<div class="paragraph">
<p>To run Discovery services you can use this command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">docker run -it -d --name=api index.lstbknd.net/lastbackend/discovery discovery [options]</code></pre>
</div>
</div>
<div class="paragraph">
<p>The available options:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 4. Table Options</caption>
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Environment</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--access-token</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_ACCESS_TOKEN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Access token to API server</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--bind-address</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_BIND_ADDRESS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.0.0.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DNS server bind address</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--bind-port</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_DNS_PORT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">53</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DNS port listening</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--dns-ttl</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_DNS_TTL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">24h</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DNS cache ttl (24 hours)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--storage</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_STORAGE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">etcd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Set storage driver (Allow: etcd, mock)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--etcd-cert-file</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_ETCD_CERT_FILE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ETCD database cert file path</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--etcd-private-key-file</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_ETCD_PRIVATE_KEY_FILE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ETCD database private key file path</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--etcd-ca-file</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_ETCD_CA_FILE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ETCD database certificate authority file</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--etcd-endpoints</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_ETCD_ENDPOINTS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">slice of string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">127.0.0.1:2379</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ETCD database endpoints list</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--etcd-prefix</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_ETCD_PREFIX</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">lastbackend</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ETCD database storage prefix</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--api-uri</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_API_URI</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">REST API endpoint</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--api-tls-cert-file</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_API_CERT_FILE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">REST API TLS certificate file path</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--api-tls-private-key-file</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_API_PRIVATE_KEY_FILE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">REST API TLS private key file path</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--api-tls-ca-file</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_API_CA_FILE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">REST API TSL certificate authority file path</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--verbose, -v</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_VERBOSE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Set log level from 0 to 7</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--config, -c</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_CONFIG</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Path for the configuration file</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--help, -h</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Print usage</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Or you can use config file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="head"><span class="head">---</span></span>
<span class="comment">#</span>
<span class="comment"># Last.Backend LLC CONFIDENTIAL</span>
<span class="comment"># _____________________________</span>
<span class="comment">#</span>
<span class="comment"># [2014] - [2019] Last.Backend LLC</span>
<span class="comment"># All Rights Reserved.</span>
<span class="comment">#</span>
<span class="comment"># NOTICE:  All information contained herein is, and remains</span>
<span class="comment"># the property of Last.Backend LLC and its suppliers,</span>
<span class="comment"># if any.  The intellectual and technical concepts contained</span>
<span class="comment"># herein are proprietary to Last.Backend LLC</span>
<span class="comment"># and its suppliers and may be covered by Russian Federation and Foreign Patents,</span>
<span class="comment"># patents in process, and are protected by trade secret or copyright law.</span>
<span class="comment"># Dissemination of this information or reproduction of this material</span>
<span class="comment"># is strictly forbidden unless prior written permission is obtained</span>
<span class="comment"># from Last.Backend LLC.</span>
<span class="comment">#</span>
<span class="comment">#</span>
<span class="comment"># ===============================================================================</span>
<span class="comment"># Discovery config settings =====================================================</span>
<span class="comment"># ===============================================================================</span>

<span class="comment"># Log level [0-7]</span>
<span class="key">verbose</span>: <span class="string"><span class="content">integer</span></span>
<span class="comment"># Authentication token</span>
<span class="comment"># Usages:</span>
<span class="comment">#   As header: Authorization Bearer &lt;token&gt;</span>
<span class="comment">#   As querystring parameter: x-lastabckend=&lt;token&gt;</span>
<span class="key">token</span>: <span class="string"><span class="content">string</span></span>


<span class="comment"># Storage settings</span>
<span class="key">storage</span>:
  <span class="comment"># Storage driver type (Only: etcd)</span>
  <span class="key">driver</span>: <span class="string"><span class="content">string</span></span>
  <span class="comment"># Etcd storage driver</span>
  <span class="key">etcd</span>:
    <span class="comment"># Last.Backend cluster database prefix</span>
    <span class="key">prefix</span>: <span class="string"><span class="content">string</span></span>
    <span class="comment"># ETCD endpoints list</span>
    <span class="key">endpoints</span>: <span class="string"><span class="content">[string]</span></span>
  <span class="comment"># Etcd authentication TLS settings</span>
  <span class="key">tls</span>:
    <span class="comment"># TLS certificate file path</span>
    <span class="key">cert</span>: <span class="string"><span class="content">string</span></span>
    <span class="comment"># TLS private key file path</span>
    <span class="key">key</span>: <span class="string"><span class="content">string</span></span>
    <span class="comment"># TLS certificate authority file path</span>
    <span class="key">ca</span>: <span class="string"><span class="content">string</span></span>


<span class="comment"># Discovery DNS server listen and cache options</span>
<span class="key">dns</span>:
<span class="error">        </span><span class="comment"># DNS address listen</span>
  <span class="key">host</span>: <span class="string"><span class="content">string</span></span>
  <span class="comment"># DNS port listen</span>
  <span class="key">port</span>: <span class="string"><span class="content">integer</span></span>
  <span class="comment"># DNS TTL options for records cache</span>
  <span class="key">ttl</span>: <span class="string"><span class="content">duration</span></span>


<span class="comment"># REST API client options</span>
<span class="key">api</span>:
  <span class="comment"># REST API Endpoint (http://127.0.0.1)</span>
  <span class="key">uri</span>: <span class="string"><span class="content">string</span></span>
  <span class="comment"># REST API TLS options</span>
  <span class="key">tls</span>:
    <span class="comment"># REST API TLS client certificate file path</span>
    <span class="key">cert</span>: <span class="string"><span class="content">string</span></span>
    <span class="comment"># REST API TLS private key file path</span>
    <span class="key">key</span>: <span class="string"><span class="content">string</span></span>
    <span class="comment"># REST API TLS client certificate authority file path</span>
    <span class="key">ca</span>: <span class="string"><span class="content">string</span></span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ingress"><a class="anchor" href="#_ingress"></a>3.1.5. Ingress</h4>
<div class="paragraph">
<p>REST API component is the control point to manage Last.Backend cluster.
It validates and configures data for the api objects which include pods, services, deployments, routes, and others.</p>
</div>
<div class="paragraph">
<p>REST API is distributed as docker image, located at: <code>index.lstbknd.net/lastbackend/lastbackend</code></p>
</div>
<div class="paragraph">
<p>To run REST API server you can use this command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">docker run -it -d --name=api index.lstbknd.net/lastbackend/lastbackend api [options]</code></pre>
</div>
</div>
<div class="paragraph">
<p>The available options:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 5. Table Options</caption>
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Environment</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--access-token</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_ACCESS_TOKEN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Access token to API server</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--haproxy-config-path</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_HAPROXY_CONFIG_PATH</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/var/run/lastbackend/ingress/haproxy/haproxy.cfg</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HAProxy configuration path setup</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--haproxy-pid</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_HAPROXY_PID</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/var/run/lastbackend/ingress/haproxy/haproxy.pid</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HAProxy pid file path</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--haproxy-exec</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_HAPROXY_EXEC</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/usr/local/bin/haproxy</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HAProxy entrypoint path</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--haproxy-stat-port</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_HAPROXY_STAT_PORT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1936</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HAProxy statistic port definition. If not provided - statistic will be disabled</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--haproxy-stat-username</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_HAPROXY_STAT_USER</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HAProxy statistic access username</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--haproxy-stat-password</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_HAPROXY_STAT_PASS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HAProxy statistic access password</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--bind-interface</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_INGRESS_BIND_INTERFACE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">eth0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Exporter bind network interface</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--network-proxy</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_NETWORK_PROXY</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ipvs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Container proxy interface driver</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--network-proxy-iface-internal</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_NETWORK_PROXY_IFACE_INTERNAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">docker0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Network internal interface binding</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--network-proxy-iface-external</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_NETWORK_PROXY_IFACE_EXTERNAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">eth0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Network container bridge binding</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--network-driver</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_NETWORK_DRIVER</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vxlan</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Container overlay network driver</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--network-driver-iface-external</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_NETWORK_DRIVER_IFACE_EXTERNAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">eth0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Container overlay network external interface for host communication</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--network-driver-iface-internal</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_NETWORK_DRIVER_IFACE_INTERNAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">docker0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Container overlay network internal bridge interface for container intercommunications</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--network-resolvers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_NETWORK_RESOLVERS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">slice of string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[8.8.8.8, 8.8.4.4]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Additional resolvers IPs for Ingress</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--api-uri</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_API_URI</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">REST API endpoint</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--api-tls-cert-file</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_API_CERT_FILE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">REST API TLS certificate file path</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--api-tls-private-key-file</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_API_PRIVATE_KEY_FILE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">REST API TLS private key file path</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--api-tls-ca-file</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_API_CA_FILE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">REST API TSL certificate authority file path</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--verbose, -v</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_VERBOSE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Set log level from 0 to 7</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--config, -c</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_CONFIG</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Path for the configuration file</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--help, -h</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Print usage</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Or you can use config file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"> <span class="error">---</span>
<span class="comment">#</span>
<span class="comment"># Last.Backend LLC CONFIDENTIAL</span>
<span class="comment"># _____________________________</span>
<span class="comment">#</span>
<span class="comment"># [2014] - [2019] Last.Backend LLC</span>
<span class="comment"># All Rights Reserved.</span>
<span class="comment">#</span>
<span class="comment"># NOTICE:  All information contained herein is, and remains</span>
<span class="comment"># the property of Last.Backend LLC and its suppliers,</span>
<span class="comment"># if any.  The intellectual and technical concepts contained</span>
<span class="comment"># herein are proprietary to Last.Backend LLC</span>
<span class="comment"># and its suppliers and may be covered by Russian Federation and Foreign Patents,</span>
<span class="comment"># patents in process, and are protected by trade secret or copyright law.</span>
<span class="comment"># Dissemination of this information or reproduction of this material</span>
<span class="comment"># is strictly forbidden unless prior written permission is obtained</span>
<span class="comment"># from Last.Backend LLC.</span>
<span class="comment">#</span>
<span class="comment">#</span>
<span class="comment"># ===============================================================================</span>
<span class="comment"># Ingress config settings =======================================================</span>
<span class="comment"># ===============================================================================</span>

<span class="comment"># Log level [0-7]</span>
<span class="key">verbose</span>: <span class="string"><span class="content">integer</span></span>
<span class="comment"># Authentication token</span>
<span class="comment"># Usages:</span>
<span class="comment">#   As header: Authorization Bearer &lt;token&gt;</span>
<span class="comment">#   As querystring parameter: x-lastabckend=&lt;token&gt;</span>
<span class="key">token</span>: <span class="string"><span class="content">string</span></span>

<span class="comment"># Haproxy proxy runtime options</span>
<span class="key">haproxy</span>:
  <span class="comment"># Haproxy config file path</span>
  <span class="key">config</span>: <span class="string"><span class="content">string</span></span>
  <span class="comment"># Haproxy pid file path</span>
  <span class="key">pid</span>: <span class="string"><span class="content">string</span></span>
  <span class="comment"># Haproxy exec binary file path</span>
  <span class="key">exec</span>: <span class="string"><span class="content">string</span></span>
  <span class="comment"># Haproxy stats options</span>
  <span class="key">stats</span>:
    <span class="comment"># Haproxy stats access option: username</span>
    <span class="key">username</span>: <span class="string"><span class="content">string</span></span>
<span class="error">        </span><span class="error">        </span><span class="comment"># Haproxy stats access option: password</span>
    <span class="key">password</span>: <span class="string"><span class="content">string</span></span>
    <span class="comment"># Haproxy stats listen port (http://&lt;host&gt;:&lt;port&gt;/stats, 1936 by default)</span>
    <span class="key">port</span>: <span class="string"><span class="content">integer</span></span>


<span class="comment"># Network settings</span>
<span class="key">network</span>:
<span class="error">        </span><span class="comment"># External interface for listening worldwide</span>
<span class="error">        </span><span class="key">interface</span>: <span class="string"><span class="content">string</span><span class="content">
  # Container proxy interface
  cpi:
    # Network proxy driver (ipvs by default)
    type: string
    # proxy network interface bindings
    interface:
      # external network interface for proxy
      external:
      # internal network interface for proxy
      internal:
  # Container network interface options
  cni:
    # Container overlay network driver (vxlan by default)
    type: string</span></span>
<span class="error">        </span><span class="error">        </span><span class="comment"># overlay network interfaces bindigs</span>
<span class="error">        </span><span class="error">        </span><span class="key">iterface</span>:
<span class="error">        </span><span class="error">        </span><span class="error">        </span><span class="comment"># External network interface for network building</span>
<span class="error">        </span><span class="error">        </span><span class="error">        </span><span class="key">external</span>: <span class="string"><span class="content">string</span></span>
<span class="error">        </span><span class="error">        </span><span class="error">        </span><span class="comment"># Internal bridge network interface for network building</span>
<span class="error">        </span><span class="error">        </span><span class="error">        </span><span class="key">internal</span>: <span class="string"><span class="content">string</span></span>

  <span class="comment"># Network dns-resolver</span>
  <span class="key">resolver</span>:
    <span class="comment"># Static DNS resolvers for ingress (8.8.8.8, 8.8.8.4 by default)</span>
    <span class="key">servers</span>: <span class="string"><span class="content">[string]</span></span>


<span class="comment"># REST API client options</span>
<span class="key">api</span>:
  <span class="comment"># REST API Endpoint (http://127.0.0.1)</span>
  <span class="key">uri</span>: <span class="string"><span class="content">string</span></span>
  <span class="comment"># REST API TLS options</span>
  <span class="key">tls</span>:
    <span class="comment"># REST API TLS client certificate file path</span>
    <span class="key">cert</span>: <span class="string"><span class="content">string</span></span>
    <span class="comment"># REST API TLS private key file path</span>
    <span class="key">key</span>: <span class="string"><span class="content">string</span></span>
    <span class="comment"># REST API TLS client certificate authority file path</span>
    <span class="key">ca</span>: <span class="string"><span class="content">string</span></span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ingress_2"><a class="anchor" href="#_ingress_2"></a>3.1.6. Ingress</h4>
<div class="paragraph">
<p>REST API component is the control point to manage Last.Backend cluster.
It validates and configures data for the api objects which include pods, services, deployments, routes, and others.</p>
</div>
<div class="paragraph">
<p>REST API is distributed as docker image, located at: <code>index.lstbknd.net/lastbackend/lastbackend</code></p>
</div>
<div class="paragraph">
<p>To run REST API server you can use this command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">docker run -it -d --name=api index.lstbknd.net/lastbackend/lastbackend api [options]</code></pre>
</div>
</div>
<div class="paragraph">
<p>The available options:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 6. Table Options</caption>
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Environment</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--access-token</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_ACCESS_TOKEN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Access token to API server</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--bind-listener-address</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_BIND_LISTENER_ADDRESS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.0.0.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Exporter bind address</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--bind-listener-port</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_BIND_LISTENER_PORT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2963</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Exporter bind port</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--bind-rest-address</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_BIND_REST_ADDRESS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.0.0.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Exporter REST listener address for logs and metrics streaming</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--bind-rest-port</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_BIND_REST_PORT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2964</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Exporter REST listener port</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--tls-cert-file</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_TLS_CERT_FILE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Exporter REST TLS cert file path</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--tls-private-key-file</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_TLS_PRIVATE_KEY</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Exporter REST TLS private key path</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--tls-ca-file</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_TLS_CA_FILE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Exporter REST TLS certificate authority file path</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--api-uri</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_API_URI</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">REST API endpoint</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--api-tls-cert-file</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_API_CERT_FILE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">REST API TLS certificate file path</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--api-tls-private-key-file</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_API_PRIVATE_KEY_FILE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">REST API TLS private key file path</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--api-tls-ca-file</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_API_CA_FILE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">REST API TSL certificate authority file path</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--bind-interface</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_BIND_INTERFACE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">eth0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Exporter bind network interface</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--log-workdir</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_LOG_WORKDIR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/var/run/lastbackend</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Set directory on host for logs storage</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--verbose, -v</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_VERBOSE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Set log level from 0 to 7</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--config, -c</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LB_CONFIG</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ ]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Path for the configuration file</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--help, -h</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Print usage</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Or you can use config file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="head"><span class="head">---</span></span>
<span class="comment">#</span>
<span class="comment"># Last.Backend LLC CONFIDENTIAL</span>
<span class="comment"># _____________________________</span>
<span class="comment">#</span>
<span class="comment"># [2014] - [2019] Last.Backend LLC</span>
<span class="comment"># All Rights Reserved.</span>
<span class="comment">#</span>
<span class="comment"># NOTICE:  All information contained herein is, and remains</span>
<span class="comment"># the property of Last.Backend LLC and its suppliers,</span>
<span class="comment"># if any.  The intellectual and technical concepts contained</span>
<span class="comment"># herein are proprietary to Last.Backend LLC</span>
<span class="comment"># and its suppliers and may be covered by Russian Federation and Foreign Patents,</span>
<span class="comment"># patents in process, and are protected by trade secret or copyright law.</span>
<span class="comment"># Dissemination of this information or reproduction of this material</span>
<span class="comment"># is strictly forbidden unless prior written permission is obtained</span>
<span class="comment"># from Last.Backend LLC.</span>
<span class="comment">#</span>
<span class="comment">#</span>
<span class="comment"># ===============================================================================</span>
<span class="comment"># Exporter config settings ======================================================</span>
<span class="comment"># ===============================================================================</span>

<span class="comment"># Log level [0-7]</span>
<span class="key">verbose</span>: <span class="string"><span class="content">integer</span></span>
<span class="comment"># Authentication token</span>
<span class="comment"># Usages:</span>
<span class="comment">#   As header: Authorization Bearer &lt;token&gt;</span>
<span class="comment">#   As querystring parameter: x-lastabckend=&lt;token&gt;</span>
<span class="key">token</span>: <span class="string"><span class="content">string</span></span>


<span class="comment"># Cluster exporter http-server settings</span>
<span class="key">server</span>:
  <span class="comment"># Exporter API server listen address (0.0.0.0 by default)</span>
  <span class="key">host</span>: <span class="string"><span class="content">string</span></span>
  <span class="comment"># Exporter API server port listen option (2964 by defaul)</span>
  <span class="key">port</span>: <span class="string"><span class="content">integer</span></span>
  <span class="comment"># Https/tls configurations</span>
  <span class="key">tls</span>:
<span class="error">        </span>  <span class="comment"># TLS certificate file path</span>
<span class="error">        </span>  <span class="key">cert</span>: <span class="string"><span class="content">string</span></span>
<span class="error">        </span>  <span class="comment"># TLS private key file path</span>
<span class="error">        </span>  <span class="key">key</span>: <span class="string"><span class="content">string</span></span>
<span class="error">        </span>  <span class="comment"># TLS certificate authority file path</span>
<span class="error">        </span>  <span class="key">ca</span>: <span class="string"><span class="content">string</span></span>

<span class="key">logger</span>:
  <span class="comment"># Logger exporter configuration</span>
  <span class="key">workdir</span>: <span class="string"><span class="content">string</span></span>
  <span class="comment"># logger tcp server listen options (0.0.0.0 by default)</span>
  <span class="key">host</span>: <span class="string"><span class="content">string</span></span>
  <span class="comment"># logger tcp server port  (2963 by default)</span>
  <span class="key">port</span>: <span class="string"><span class="content">integer</span></span>


<span class="comment"># REST API client options</span>
<span class="key">api</span>:
  <span class="comment"># REST API Endpoint (http://127.0.0.1)</span>
  <span class="key">uri</span>: <span class="string"><span class="content">string</span></span>
  <span class="comment"># REST API TLS options</span>
  <span class="key">tls</span>:
    <span class="comment"># REST API TLS client certificate file path</span>
    <span class="key">cert</span>: <span class="string"><span class="content">string</span></span>
    <span class="comment"># REST API TLS private key file path</span>
    <span class="key">key</span>: <span class="string"><span class="content">string</span></span>
    <span class="comment"># REST API TLS client certificate authority file path</span>
    <span class="key">ca</span>: <span class="string"><span class="content">string</span></span>

<span class="comment"># Network settings</span>
<span class="key">network</span>:
  <span class="comment"># Public network interface to determine exporter access endpoint (eth0 by default)</span>
  <span class="key">interface</span>: <span class="string"><span class="content">string</span></span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_development_installation"><a class="anchor" href="#_development_installation"></a>3.2. Development Installation</h3>
<div class="paragraph">
<p>You can create and test Last.Backend clusters in a few minutes on your laptop using docker-machine for example.</p>
</div>
<div class="paragraph">
<p>Use this type of installation if you want to:
- Develop and contributing Last.Backend</p>
</div>
<div class="paragraph">
<p>Here you can learn how to deploy Last.Backend cluster with docker-machine:</p>
</div>
<div class="paragraph">
<p><strong>Prerequisites</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Go 1.7 or higher</p>
</li>
<li>
<p>Go docker client v17.03</p>
</li>
<li>
<p>Go etcd client for v3</p>
</li>
<li>
<p>Git</p>
</li>
<li>
<p>docker-machine</p>
</li>
<li>
<p>virtualbox</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For creating local development environment we suggest you to use docker-machine provision type:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">$ go get github.com/lastbackend/lastbackend
$ cd ${GOPATH:-~/go}/src/github.com/lastbackend/lastbackend
$ make deps &amp;&amp; make build &amp;&amp; make install</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Create local development environment</strong></p>
</div>
<div class="paragraph">
<p>use docker-machine to create nodes for cluster</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash"># set sources path
export LB_SOURCES_PATH=/opt/src/github.com/lastbackend/lastbackend
cd ${LB_SOURCES_PATH}
make deps

# create master node
docker-machine create --driver virtualbox master
docker-machine stop master
# note: for virtulabox driver we can mount host dir into docker-machine with this command
VBoxManage sharedfolder add master --name /lastbackend --hostpath $LB_SOURCES_PATH --automount
docker-machine start master

# create minion nodes
docker-machine create --driver virtualbox minion-00
docker-machine stop minion-00
VBoxManage sharedfolder add minion-00 --name /lastbackend --hostpath $LB_SOURCES_PATH --automount
docker-machine start minion-00

# run etcd on master machine
eval (docker-machine env master)
make image
export MASTER_IP=$(docker-machine ip master)
docker run -d -p 4001:4001 -p 2380:2380 -p 2379:2379 \
 --name etcd quay.io/coreos/etcd:v3.2.9 /usr/local/bin/etcd \
 -name etcd0 \
 -advertise-client-urls http://${MASTER_IP}:2379,http://${MASTER_IP}:4001 \
 -listen-client-urls http://0.0.0.0:2379,http://0.0.0.0:4001 \
 -initial-advertise-peer-urls http://${MASTER_IP}:2380 \
 -listen-peer-urls http://0.0.0.0:2380 \
 -initial-cluster-token etcd-cluster-1 \
 -initial-cluster etcd0=http://${MASTER_IP}:2380 \
 -initial-cluster-state new

# fetch deps
docker run --rm -it  \
      -v /lastbackend:/go/src/github.com/lastbackend/lastbackend \
      -w /go/src/github.com/lastbackend/lastbackend \
      --name=deps \
      --net=host \
      golang ./hack/bootstrap.sh

# run Last.Backend Cluster API from sources in docker
docker run -d -it --restart=always \
      -v /lastbackend:/go/src/github.com/lastbackend/lastbackend \
      -v /lastbackend/contrib/config.yml:/etc/lastbackend/config.yml \
      -w /go/src/github.com/lastbackend/lastbackend \
      --name=api \
      --net=host \
      lastbackend/lastbackend go run ./cmd/kit/kit.go api -c /etc/lastbackend/config.yml

# run Last.Backend Cluster CTL from sources in docker
docker run -d -it --restart=always \
      -v /lastbackend:/go/src/github.com/lastbackend/lastbackend \
      -v /lastbackend/contrib/config.yml:/etc/lastbackend/config.yml \
      -w /go/src/github.com/lastbackend/lastbackend \
      --name=ctl \
      lastbackend/lastbackend go run ./cmd/kit/kit.go ctl -c /etc/lastbackend/config.yml

# run Last.Backend Cluster Discovery from sources in docker
docker run -d -it --restart=always \
      -v /lastbackend:/go/src/github.com/lastbackend/lastbackend \
      -v /lastbackend/contrib/discovery.yml:/etc/lastbackend/config.yml \
      -w /go/src/github.com/lastbackend/lastbackend \
      --net=host \
      --name=discovery \
      lastbackend/discovery go run ./cmd/discovery/discovery.go ctl -c /etc/lastbackend/config.yml

# run Last.Backend Cluster Ingress from sources in docker
docker run -d -it --restart=always \
      -v /lastbackend:/go/src/github.com/lastbackend/lastbackend \
      -v /lastbackend/contrib/ingress.yml:/etc/lastbackend/config.yml \
      -w /go/src/github.com/lastbackend/lastbackend \
      --net=host \
      --name=ingress \
      lastbackend/ingress go run ./cmd/ingress/ingress.go ctl -c /etc/lastbackend/config.yml


# run node on minion host
# create minion node
docker-machine create --driver virtualbox minion-00
docker-machine stop minion-00
VBoxManage sharedfolder add minion-00 --name /lastbackend --hostpath $LB_SOURCES_PATH --automount
docker-machine start minion-00

# enable modprobe ip_vs for internal load balancing
# this is required for boot2docker iso image
docker-machine ssh minion-00 &quot;sudo modprobe ip_vs&quot;

eval (docker-machine env minion-00)
make image
# install deps for sources
docker run --rm -it  \
      -v /lastbackend:/go/src/github.com/lastbackend/lastbackend \
      -w /go/src/github.com/lastbackend/lastbackend \
      --name=deps \
      --net=host \
      golang ./hack/bootstrap.sh

# run node container
docker run -d -it --restart=always \
-v /lastbackend:/go/src/github.com/lastbackend/lastbackend \
-v /lastbackend/contrib/node.yml:/etc/lastbackend/config.yml \
-v /var/run/docker.sock:/var/run/docker.sock \
-v /var/run/lastbackend:/var/run/lastbackend \
-v /lib/modules:/lib/modules:rw \
-w /go/src/github.com/lastbackend/lastbackend \
-e LB_API_URI=&quot;$MASTER_IP:2967&quot; \
-e LB_DNS_IPS=&quot;$MASTER_IP&quot; \
--privileged \
--name=node \
--net=host \
index.lstbknd.net/lastbackend/lastbackend go run ./cmd/node/node.go -c /etc/lastbackend/config.yml

# check logs
docker logs -f node</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_local_installation"><a class="anchor" href="#_local_installation"></a>3.3. Local Installation</h3>
<div class="paragraph">
<p>A local installation is an easy way to get started. You can create and test Last.Backend clusters in a few minutes on your laptop using docker-machine for example.</p>
</div>
<div class="paragraph">
<p>Use this type of installation if you want to:
- Try and test cluster</p>
</div>
<div class="paragraph">
<p>Here you can learn how to deploy Last.Backend cluster with docker-machine.</p>
</div>
<div class="paragraph">
<p>use docker-machine to create nodes for cluster</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash"># create master node
docker-machine create --driver virtualbox master

# create minion nodes
docker-machine create --driver virtualbox minion-00

# run etcd on master machine
eval $(docker-machine env master)
export MASTER_IP=$(docker-machine ip master)
docker run -d -p 4001:4001 -p 2380:2380 -p 2379:2379 \
 --name etcd quay.io/coreos/etcd:v3.2.9 /usr/local/bin/etcd \
 -name etcd0 \
 -advertise-client-urls http://${MASTER_IP}:2379,http://${MASTER_IP}:4001 \
 -listen-client-urls http://0.0.0.0:2379,http://0.0.0.0:4001 \
 -initial-advertise-peer-urls http://${MASTER_IP}:2380 \
 -listen-peer-urls http://0.0.0.0:2380 \
 -initial-cluster-token etcd-cluster-1 \
 -initial-cluster etcd0=http://${MASTER_IP}:2380 \
 -initial-cluster-state new

# run Last.Backend Cluster API:
docker run -d -it --restart=always \
      --net=host \
      --name=api \
      index.lstbknd.net/lastbackend/lastbackend api

# run Last.Backend Cluster CTL:
docker run -d -it --restart=always \
      --name=controller \
      index.lstbknd.net/lastbackend/lastbackend ctl

# run Last.Backend Cluster DNS:
docker run -d -it --restart=always \
      --name=discovery \
      index.lstbknd.net/lastbackend/discovery

# run Last.Backend Cluster Exporter:
docker run -d -it --restart=always \
      --name=exporter \
      index.lstbknd.net/lastbackend/exporter

# run node on minion host
# enable modprobe ip_vs for internal load balancing
# this is required for boot2docker iso image
docker-machine ssh minion-00 &quot;sudo modprobe ip_vs&quot;

# run Last.Backend Cluster Node:
docker run -d -it --restart=always \
-v /var/run/docker.sock:/var/run/docker.sock \
-v /var/run/lastbackend:/var/run/lastbackend \
-v /lib/modules:/lib/modules:rw \
-e LB_API_URI=&quot;$MASTER_IP:2967&quot; \
--privileged \
--name=node \
--net=host \
index.lstbknd.net/lastbackend/lastbackend node

# run Last.Backend Cluster Ingress:
docker run -d -it --restart=always \
--name=ingress \
--net=host \
index.lstbknd.net/lastbackend/ingress</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_self_hosted_installation"><a class="anchor" href="#_self_hosted_installation"></a>3.4. Self-Hosted Installation</h3>
<div class="paragraph">
<p>Self Hosted installation is a good way to create and maintain your own Last.Backend cluster for teams and companies</p>
</div>
<div class="paragraph">
<p>Use this type of installation if you want to:
- Get a company/team cluster on your infrastructure
- Focus on apps development speed without worrying for delivery process.</p>
</div>
<div class="paragraph">
<p>Here you can learn how to deploy Last.Backend cluster with ansible.</p>
</div>
</div>
<div class="sect2">
<h3 id="_last_backend_hosted_installation"><a class="anchor" href="#_last_backend_hosted_installation"></a>3.5. Last.Backend Hosted Installation</h3>
<div class="paragraph">
<p>Last.Backend Hosted installation is the best way to create and maintain Last.Backend cluster for teams and companies in one click
On this type of installation, you will get Last.Backend cluster, managed by Last.Backend team.</p>
</div>
<div class="paragraph">
<p>Use this type of installation if you want to:
- Get a company/team cluster on your infrastructure
- Focus on apps development speed without worrying for delivery process.
- Have high availability cluster, managed by Last.Backend team</p>
</div>
<div class="paragraph">
<p>You can request for your dedicated cluster on control panel(soon) or by email: <a href="mailto:request@lastbackend.com">request@lastbackend.com</a></p>
</div>
</div>
<div class="sect2">
<h3 id="_provider_hosted_installation"><a class="anchor" href="#_provider_hosted_installation"></a>3.6. Provider Hosted Installation</h3>
<div class="paragraph">
<p>Provider Hosted installation is a convenient way to create and maintain Last.Backend cluster for teams and companies in one click</p>
</div>
<div class="paragraph">
<p>Use this type of installation if you want to:
- Get a company/team cluster on your infrastructure
- Focus on apps development speed without worrying for delivery process.
- Have high availability cluster, managed by providers</p>
</div>
<div class="paragraph">
<p>Now we are in integration stage with a lot of different hosting providers across the globe. For more information you can contact us: <a href="mailto:partners@lastbackend.com">partners@lastbackend.com</a></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_design_manifest"><a class="anchor" href="#_design_manifest"></a>4. Design manifest</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Design section described the parts of the Last.Backend platform and the abstractions to helps you obtain a deeper understanding of how it works.</p>
</div>
<div class="sect2">
<h3 id="_overview_2"><a class="anchor" href="#_overview_2"></a>4.1. Overview</h3>
<div class="paragraph">
<p>Last.Backend platform is a set of processes of 2 types: master processes and minion processes. Master processes operates with cluster state, non-master applying state on physical machines.
In the core of design principles of Last.Backend there are runtime objects(manifests). Using manifest, you can change Last.Backend cluster state.
Manifests can be 2 types:
- external - to pass changes into cluster
- internal - intercommunication system manifests</p>
</div>
</div>
<div class="sect2">
<h3 id="_manifests"><a class="anchor" href="#_manifests"></a>4.2. Manifests</h3>
<div class="paragraph">
<p>There is only 1 endpoint to handle manifests - the REST API. Manifests can be several types:
- Namespace manifest
- Service manifest
- Secret manifest
- Config manifest
- Route manifest</p>
</div>
<div class="paragraph">
<p>In the internal communication process Last.Backend also uses manifests:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Node manifest: - collection of node state manifests:</p>
</li>
<li>
<p>Pod manifests - map of pod manifests, that should be on node</p>
</li>
<li>
<p>Endpoint manifests - map of endpoints manifests, that should be on node</p>
</li>
<li>
<p>Volume Manifests - map of volumes manifests</p>
</li>
<li>
<p>Congig Manifests -  map of config manifests</p>
</li>
<li>
<p>Secret Manifests - map of secrets manifests</p>
</li>
<li>
<p>Subnets Manifests - network subnets manifests</p>
</li>
<li>
<p>Resolvers Manifests - cluster resolvers manifests</p>
</li>
<li>
<p>Ingress manifest:</p>
</li>
<li>
<p>Resolvers Manifests - cluster resolvers manifests</p>
</li>
<li>
<p>Endpoint manifests - map of services endpoint manifests</p>
</li>
<li>
<p>Routes manifests - map of routes manifests</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>More about manifests you can read in particular object section in this docs. For example service manifest is described in Serices section.</p>
</div>
</div>
<div class="sect2">
<h3 id="_processes"><a class="anchor" href="#_processes"></a>4.3. Processes</h3>
<div class="paragraph">
<p>We can separate all Last.Backend processes in to types:
- master processes
- minion processes</p>
</div>
<div class="paragraph">
<p>To master process group we can set: REST API, Controller, Discovery and Ingress
To minion process group we can set node.</p>
</div>
<div class="paragraph">
<p>All master process can be horizontally scaled, except controller. It can be also scaled, but master process should be one, others will be set as slaves.</p>
</div>
<div class="paragraph">
<p>Last.Backend REST API is designed to setup cluster state directly or with command line interface application.
The main REST API function is to validate incomming changes, and pass they into database.</p>
</div>
<div class="paragraph">
<p>Last.Backend Controller is a process that operates for cluster state match.
After state is changed, controller start applying changes to make cluster state match.
The main design of controlles - is to handle current state, receive new update from database and preform a variety of automated tasks such as creating new deployment, pod, changind replicas, scheduling containers and volumes, and more.
Controller handles all cluster state and watches nodes state, handles capacity cluster information and more data. It also performs cluster automated tasks, based on nodes or ingress states.
For example it can reschedule pods after not rechanble timeout.</p>
</div>
<div class="paragraph">
<p>Last.Backend Discovery - is service discovery process, that handles all information on services registrations and internal domain names. In two words it is an internal DNS server for services.</p>
</div>
<div class="paragraph">
<p>Last.Backend Ingress - is the entry point for external traffics to internal network. It is auto-configured HAproxy server, which proxy traffic by routes rules to internal endpoints.</p>
</div>
<div class="paragraph">
<p>Last.Backend minion node - is a minion process that perform all operations with containers, volumes and networks on physical machine.
Node communicates with REST API. It pull state changes and send current state information about pods, volumes, endpoint, system info and more.</p>
</div>
</div>
<div class="sect2">
<h3 id="_storage"><a class="anchor" href="#_storage"></a>4.4. Storage</h3>
<div class="paragraph">
<p>Last.Backend uses storage package to store information about cluster state.</p>
</div>
<div class="paragraph">
<p>As main database Last.Backend uses ETCDv3. For more information about storage tree and available methods, you can read design/storage section.
Etcd is a distributed key value store that provides a reliable way to store data across a cluster of machines.
Its an open-source and available on GitHub. etcd gracefully handles leader elections during network partitions and will tolerate machine failure, including the leader.</p>
</div>
<div class="paragraph">
<p>More information about ETCD you can read on the main etcd website: <a href="https://coreos.com/etcd/">https://coreos.com/etcd/</a></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_network_design"><a class="anchor" href="#_network_design"></a>5. Network Design</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Last.Backend approaches networking by default installation. There are 3 types of network communications:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Container-to-container communications in the pod realized by using one vnet interface by containers in one pod.</p>
</li>
<li>
<p>Pod-to-pod communications realized by endpoint.</p>
</li>
<li>
<p>External-to-Service commutication is realized by endpoints and ingress.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Last.Backend assumes that pods can communicate with other pods, across hosts.
Every pod gets its own IP address so you do not need to create links between pods or mapping container ports to host ports.
This design provides you clean network model, where pod is like separated host in your cluster.</p>
</div>
<div class="sect2">
<h3 id="_network_runtime"><a class="anchor" href="#_network_runtime"></a>5.1. Network Runtime</h3>
<div class="paragraph">
<p>Last.Backend uses 2 network runtime interfaces:
- CNI - to perform overlay network operations
- CPI - to perform network proxy operations</p>
</div>
</div>
<div class="sect2">
<h3 id="_cni"><a class="anchor" href="#_cni"></a>5.2. CNI</h3>
<div class="paragraph">
<p>CNI runtime interface operates with network in 5 methods:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="golang">        Info(ctx context.Context) *types.NetworkState
        Create(ctx context.Context, network *types.SubnetManifest) (*types.NetworkState, error)
        Destroy(ctx context.Context, network *types.NetworkState) error
        Replace(ctx context.Context, state *types.NetworkState, manifest *types.SubnetManifest) (*types.NetworkState, error)
        Subnets(ctx context.Context) (map[string]*types.NetworkState, error)</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">Subnets - return all subnets in network state</div>
<p>Current version of Last.Backend contains VxLAN overlay network implemetation.
VxLAN driver automatically creates network interface for communications, creates ARP, FBD rules to reach hosts in network.
To enable VxLAN network in cluster, you need to pass runtime.cni type to "xvlan".
CNI automatically detect default network interface, but if you need to setup a specific interface in node: just put in the runtime.interface option.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">runtime</span>:
  <span class="key">interface</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">eth1</span><span class="delimiter">&quot;</span></span> <span class="comment">#external interface to route traffic</span>
  <span class="key">cni</span>:
    <span class="key">type</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">vxlan</span><span class="delimiter">&quot;</span></span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_cpi"><a class="anchor" href="#_cpi"></a>5.3. CPI</h3>
<div class="paragraph">
<p>CPI runtime interface operates with proxy endpoints in 4 methods:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="golang">        Info(ctx context.Context) (map[string]*types.EndpointState, error)
        Create(ctx context.Context, manifest *types.EndpointManifest) (*types.EndpointState, error)
        Destroy(ctx context.Context, state *types.EndpointState) error
        Update(ctx context.Context, state *types.EndpointState, manifest *types.EndpointManifest) (*types.EndpointState, error)</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">Update -  update endpoint rules</div>
<p>Current version of Last.Backend contains IPVS proxy implemetation.
IPVS driver manages IPVS configuration on node, creates new endpoint services and backends
IPVS driver automatically creates ipvs dummy network interface for communications, attach cluster IP to it and manage ip routing options.
To enable IPVS proxy mode in cluster, you need to pass runtime.cpi type to "ipvs".</p>
</div>
<div class="paragraph">
<p>CNI automatically detect default network interface, but if you need to setup a specific interface in node: just put in the runtime.interface option.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">runtime</span>:
  <span class="key">interface</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">eth1</span><span class="delimiter">&quot;</span></span> <span class="comment">#external interface to route traffic</span>
  <span class="key">cpi</span>:
    <span class="key">type</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">ipvs</span><span class="delimiter">&quot;</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_last_backend_runtime"><a class="anchor" href="#_last_backend_runtime"></a>6. Last.Backend Runtime</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section describes runtime Last.Backend information about core objects, componens and other cool things.</p>
</div>
<div class="paragraph">
<p>Globally Last.Backend contains in 2 parts:
- namespace runtime
- infrastructure runtime</p>
</div>
<div class="sect2">
<h3 id="_namespace_runtime"><a class="anchor" href="#_namespace_runtime"></a>6.1. Namespace runtime</h3>
<div class="paragraph">
<p>Namespace runtime is a virtual state in cluser, contains:
- Namespace management
- Service management
- Deployment management
- Pod management
- Endpoint management
- Secret management
- Config management
- Volumes management
- Routes management</p>
</div>
<div class="sect3">
<h4 id="_namespace"><a class="anchor" href="#_namespace"></a>6.1.1. Namespace</h4>
<div class="paragraph">
<p>Namespace is like a virtual cluster in physical cluster.</p>
</div>
<div class="paragraph">
<p>Namespaces are designed for create separate isolated group of services. For example you need to use namespace to separate projects or project stages.
Each namespace is isolate from others, so you can create namespace usage quotas. All resources in namespace need to be unique within namespace, but not across namespaces.</p>
</div>
<div class="paragraph">
<p>Namespaces are a way to divide cluster resources between multiple projects (via resource quota).
It is not necessary to use multiple namespaces just to separate project version or stages, but you can use it for that.</p>
</div>
<div class="sect4">
<h5 id="_working_with_namespaces"><a class="anchor" href="#_working_with_namespaces"></a>Working with namespaces</h5>
<div class="paragraph">
<p>Creation and deletion of namespaces are described in the separated section of documentation for namespaces.</p>
</div>
<div class="paragraph">
<p>Viewing namespaces
You can list the current namespaces in a cluster using:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">$ lb namespace ls
NAME  DESCRIPTION  ENDPOINT
----  -----------  --------
demo               demo.lb.local</code></pre>
</div>
</div>
<div class="paragraph">
<p>Create new namespace:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">$ lb namespace create test
Namespace `test` is created

 NAME         test
 DESCRIPTION
 ENDPOINT     test.lb.local</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_dns_in_namespaces"><a class="anchor" href="#_dns_in_namespaces"></a>DNS in namespaces</h5>
<div class="paragraph">
<p>Each namespace receive unique DNS entry. This entry needed by services for inter-cluster communitation.
When you create a Service, it creates a corresponding DNS entry based on namespace DNS.
This entry is of the form &lt;service-name&gt;.&lt;namespace-name&gt;.lb.local.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_service"><a class="anchor" href="#_service"></a>6.1.2. Service</h4>
<div class="paragraph">
<p>Service in Last.Backend is your running app. Service is set of apps deployments, where only one deployment can be in active state.
The main idea of services is to create one specification of your app with all needed information, such as container images, network settings, volumes binding and other.</p>
</div>
<div class="paragraph">
<p>Services can be 2 types:
- stateless - services that not handle working state information,
- statefull - services that handle working state</p>
</div>
<div class="sect4">
<h5 id="_stateless_services"><a class="anchor" href="#_stateless_services"></a>Stateless services</h5>
<div class="paragraph">
<p>Stateless services are the common type of services you need to use in your microservices architecture.
This type of services can be easilly replicated across the cluster of nodes.</p>
</div>
</div>
<div class="sect4">
<h5 id="_statefull_services"><a class="anchor" href="#_statefull_services"></a>Statefull services</h5>
<div class="paragraph">
<p>Stateless services are the common type of services you need to use in you need to run database or similar application.
This type of services in Last.Backend workflow should be hard binded to particular node, and should not be scale horizontally.
But you can always migrate service from one node to another with all data.</p>
</div>
</div>
<div class="sect4">
<h5 id="_working_with_services"><a class="anchor" href="#_working_with_services"></a>Working with services</h5>
<div class="paragraph">
<p>Creation and deletion of services are fully described in the separated section of documentation for services.</p>
</div>
<div class="sect5">
<h6 id="_viewing_services_in_namespace"><a class="anchor" href="#_viewing_services_in_namespace"></a>Viewing services in namespace</h6>
<div class="paragraph">
<p>You can list the current service in a namespace using:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">$ lb service ls &lt;namespace name&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">$ lb service ls demo

 NAME   ENDPOINT             STATUS  REPLICAS
 ----   --------             ------  --------
 2048   2048.demo.lb.local   ready
 proxy  proxy.demo.lb.local  ready</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_create_new_service"><a class="anchor" href="#_create_new_service"></a>Create new service:</h6>
<div class="paragraph">
<p>The convinient way is to create service from manifest file like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">kind</span>: <span class="string"><span class="content">Service</span></span>
<span class="key">version</span>: <span class="string"><span class="content">v1</span></span>
<span class="key">meta</span>:
  <span class="key">name</span>: <span class="string"><span class="content">2048</span></span>
  <span class="key">labels</span>:
    <span class="key">type</span>: <span class="string"><span class="content">proxy</span></span>
    <span class="key">demo</span>: <span class="string"><span class="content">test</span></span>
<span class="key">spec</span>:
  <span class="key">selector</span>:
    <span class="key">node</span>:
    <span class="key">labels</span>:
      <span class="key">type</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">example</span><span class="delimiter">&quot;</span></span>
  <span class="key">replicas</span>: <span class="string"><span class="content">2</span></span>
  <span class="key">network</span>:
    <span class="key">ports</span>: <span class="string"><span class="content">[&quot;80:80/tcp&quot;]</span></span>
  <span class="key">template</span>:
    <span class="key">containers</span>:
    - <span class="string"><span class="content">name: nginx</span></span>
      <span class="key">image</span>:
        <span class="key">name</span>: <span class="string"><span class="content">evilroot/docker-2048</span></span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">$ lb namespace apply demo -f &lt;path to service manifest&gt;
Service `2048` is created</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_inspect_service"><a class="anchor" href="#_inspect_service"></a>Inspect service:</h6>
<div class="paragraph">
<p>You can view information about service with inspect command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">$lb service inspect &lt;namespace name&gt; &lt;service name&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">$lb service inspect demo 2048
Name:                demo/2048
State:                ready
Endpoint:        2048.demo.lb.local
Created:        6 days ago
Updated:        5 days ago
Labels:                demo=test type=proxy


Active deployments:

 Name:                228d38e
 State:                ready
 Created:        6 days ago
 Updated:        5 days ago

 Pods:

 Name     Ready  Status  Restarts  Age
 ----     -----  ------  --------  ---
 b62e295  1/1    ready   0         5 days ago
 f6a85e8  1/1    ready   0         5 days ago</code></pre>
</div>
</div>
<div class="paragraph">
<p>Here you can see active deployment, pods, endpoint and other helpful information about service.</p>
</div>
</div>
<div class="sect5">
<h6 id="_update_service"><a class="anchor" href="#_update_service"></a>Update service:</h6>
<div class="paragraph">
<p>The convinient way to update service is to set new service manifest file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">kind</span>: <span class="string"><span class="content">Service</span></span>
<span class="key">version</span>: <span class="string"><span class="content">v1</span></span>
<span class="key">meta</span>:
  <span class="key">name</span>: <span class="string"><span class="content">2048</span></span>
  <span class="key">labels</span>:
    <span class="key">type</span>: <span class="string"><span class="content">proxy</span></span>
    <span class="key">demo</span>: <span class="string"><span class="content">test</span></span>
<span class="key">spec</span>:
  <span class="key">selector</span>:
    <span class="key">node</span>:
    <span class="key">labels</span>:
      <span class="key">type</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">example</span><span class="delimiter">&quot;</span></span>
  <span class="key">replicas</span>: <span class="string"><span class="content">1</span></span>
  <span class="key">network</span>:
    <span class="key">ports</span>: <span class="string"><span class="content">[&quot;80:80/tcp&quot;]</span></span>
  <span class="key">template</span>:
    <span class="key">containers</span>:
    - <span class="string"><span class="content">name: nginx</span></span>
      <span class="key">image</span>:
        <span class="key">name</span>: <span class="string"><span class="content">evilroot/docker-2048</span></span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">$ lb namespace apply demo -f &lt;path to service manifest&gt;
Service `2048` is updated</code></pre>
</div>
</div>
<div class="paragraph">
<p>Last.Backend platform creates diff of current service spec and provided. It automatically creates new deployment, when container runtime information is changed.</p>
</div>
</div>
<div class="sect5">
<h6 id="_remove_service"><a class="anchor" href="#_remove_service"></a>Remove service:</h6>
<div class="paragraph">
<p>You can remove service on any stage, even it is in provision state.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">$ lb service remove demo 2048
Service `2048` is destroying now</code></pre>
</div>
</div>
<div class="paragraph">
<p>For more information about services and manifest specification, go to separated services section in documentation.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_deployment"><a class="anchor" href="#_deployment"></a>6.1.3. Deployment</h4>
<div class="paragraph">
<p>As described above, service can handle multiple deployments. Deployment is a service configuration, containes all information about how service should be run, scaled and other.</p>
</div>
<div class="paragraph">
<p>Deployment can be in several type of states:
- Created
- Provision
- Ready
- Error
- Degradation
- Destroy
- Destroyed</p>
</div>
<div class="paragraph">
<p>When service configuration is changed, Last.Backend controller should make a decision about new deployment service should be created or not.
It depends on which spec params changes.</p>
</div>
<div class="paragraph">
<p>Deployments can not be created, updated or deleted manually - they a fully managed by controller. You can only view current deployments state in service.
For more information about deployments and manifest specification, go to separated services deployments section in documentation.</p>
</div>
</div>
<div class="sect3">
<h4 id="_pod"><a class="anchor" href="#_pod"></a>6.1.4. Pod</h4>
<div class="paragraph">
<p>Pod is a minimal scalable entity in Last.Backend cluster. It can contain one container, or multiple containers with shared resources.
Pod specification is describe all rules, how host shuld create, start and manage containers.</p>
</div>
<div class="paragraph">
<p>Pod can be in several type of states:
- Created
- Provision
- Ready
- Error
- Degradation
- Destroy
- Destroyed</p>
</div>
<div class="paragraph">
<p>Pods can not be created, updated or deleted manually - they are fully managed by controller. You can only view current pods state in service deployment.
For more information about pods and manifest specification, go to separated deployment pods section in documentation</p>
</div>
</div>
<div class="sect3">
<h4 id="_endpoint"><a class="anchor" href="#_endpoint"></a>6.1.5. Endpoint</h4>
<div class="paragraph">
<p>Endpoint is an internal entrypoint for service. If you need to access service in the cluster, you need to create portMap with proxy rules.
Each endpoint receives internal cluster IP, and internal domain name in from of &lt;service name&gt;.&lt;namespace name&gt;.lb.local.</p>
</div>
<div class="sect4">
<h5 id="_create_endpoint"><a class="anchor" href="#_create_endpoint"></a>Create endpoint</h5>
<div class="paragraph">
<p>Endpoints are managed automatically by controller and depends on service specification.
That means that you can have service without endpoint, and it will not be accessible in a cluster network.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">kind</span>: <span class="string"><span class="content">Service</span></span>
<span class="key">version</span>: <span class="string"><span class="content">v1</span></span>
<span class="key">meta</span>:
  <span class="key">name</span>: <span class="string"><span class="content">2048</span></span>
  <span class="key">labels</span>:
    <span class="key">type</span>: <span class="string"><span class="content">proxy</span></span>
    <span class="key">demo</span>: <span class="string"><span class="content">test</span></span>
<span class="key">spec</span>:
  <span class="key">selector</span>:
    <span class="key">node</span>:
    <span class="key">labels</span>:
      <span class="key">type</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">example</span><span class="delimiter">&quot;</span></span>
  <span class="key">replicas</span>: <span class="string"><span class="content">1</span></span>
  <span class="key">network</span>:
    <span class="key">ports</span>: <span class="string"><span class="content">[&quot;80:8080/tcp&quot;]</span></span>
  <span class="key">template</span>:
    <span class="key">containers</span>:
    - <span class="string"><span class="content">name: nginx</span></span>
      <span class="key">image</span>:
        <span class="key">name</span>: <span class="string"><span class="content">evilroot/docker-2048</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In an example above we open service 2048 to cluster service-2-service communication by passing <code>network.ports</code> option to <code>["80:8080/tcp"]</code>.
In this line we allow access to service by 80 port, and proxy traffic to 8080 port on pod. And you can access your service from other services by <code>2048.demo.lb.local:80</code> endpoint.</p>
</div>
</div>
<div class="sect4">
<h5 id="_update_endpoint"><a class="anchor" href="#_update_endpoint"></a>Update endpoint</h5>
<div class="paragraph">
<p>You can update endpoint, by changing service.network.ports spec.
That changes affects only network settings, and new deployment will not be created.</p>
</div>
</div>
<div class="sect4">
<h5 id="_remove_endpoint"><a class="anchor" href="#_remove_endpoint"></a>Remove endpoint</h5>
<div class="paragraph">
<p>If you need to remove endpoint, just remove service.network specification rule in manifest.</p>
</div>
<div class="paragraph">
<p>For more information about endpoint and manifest specification, go to separated deployment endpoint section in documentation</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_volumes"><a class="anchor" href="#_volumes"></a>6.1.6. Volumes</h4>
<div class="paragraph">
<p>Volume is a storage for your services data. When new volume is placed in cluster state, node agent creates a directory on host.
This directory is mounted to containers according mount rules, specified in service sepcification.</p>
</div>
</div>
<div class="sect3">
<h4 id="_secret"><a class="anchor" href="#_secret"></a>6.1.7. Secret</h4>
<div class="paragraph">
<p>Secret is designed to store sensitive information. You can deside yourself, what type of information is sensitive, but in common it is passwords, tokens, ssh keys.
If you need to use secrets, you should attach it in to pod. There is 2 options how you can do it:
- attach secret to pod as file placed in volume
- attach secret data to pod environment</p>
</div>
<div class="paragraph">
<p>Secret contains map of key=value, so you can store in one secret multiple key=values pairs or files.</p>
</div>
<div class="sect4">
<h5 id="_get_secrets"><a class="anchor" href="#_get_secrets"></a>Get secrets</h5>
<div class="paragraph">
<p>To receive secret list in namespace use:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">$lb secret ls &lt;namespace name&gt;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_inspect_secret"><a class="anchor" href="#_inspect_secret"></a>Inspect secret</h5>
<div class="paragraph">
<p>To get secret information use:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">$lb secret inspect &lt;namespace name&gt; &lt;secret name&gt;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_create_secret"><a class="anchor" href="#_create_secret"></a>Create secret</h5>
<div class="paragraph">
<p>You can create secret in few types:
- auth - secret type designed to store Username and Password.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">$lb secret create &lt;namespace name&gt; &lt;name&gt; -a -u &lt;username&gt; -p &lt;password&gt;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>text - secret type designed to store key=value info.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>$lb secret create &lt;namespace name&gt; &lt;name&gt; -t &lt;key&gt;=&lt;value&gt; -t &lt;key2&gt;=&lt;value2&gt;</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>file - secret type designed to store sensitive files, like ssh-keys</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>$lb secret create &lt;namespace name&gt; &lt;name&gt; -f &lt;file path&gt;</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_attach_secret_to_service_as_environment_variable"><a class="anchor" href="#_attach_secret_to_service_as_environment_variable"></a>Attach secret to service as environment variable</h5>
<div class="paragraph">
<p>To attach secret to environment variable in service, you need modify service container spec and set <code>env.secret.name</code> to select secret and <code>env.secret.key</code> to select secret key value of should be used.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">kind</span>: <span class="string"><span class="content">Service</span></span>
<span class="key">version</span>: <span class="string"><span class="content">v1</span></span>
<span class="key">meta</span>:
  <span class="key">name</span>: <span class="string"><span class="content">2048</span></span>
  <span class="key">labels</span>:
    <span class="key">type</span>: <span class="string"><span class="content">proxy</span></span>
    <span class="key">demo</span>: <span class="string"><span class="content">test</span></span>
<span class="key">spec</span>:
  <span class="key">selector</span>:
    <span class="key">node</span>:
    <span class="key">labels</span>:
      <span class="key">type</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">example</span><span class="delimiter">&quot;</span></span>
  <span class="key">replicas</span>: <span class="string"><span class="content">1</span></span>
  <span class="key">network</span>:
    <span class="key">ports</span>: <span class="string"><span class="content">[&quot;80:8080/tcp&quot;]</span></span>
  <span class="key">template</span>:
    <span class="key">containers</span>:
    - <span class="string"><span class="content">name: nginx</span></span>
      <span class="key">image</span>:
        <span class="key">name</span>: <span class="string"><span class="content">evilroot/docker-2048</span></span>
      <span class="key">env</span>:
        - <span class="string"><span class="content">name: &lt;env name&gt;</span></span>
          <span class="key">secret</span>:
            <span class="key">name</span>: <span class="string"><span class="content">&lt;secret name&gt;</span></span>
            <span class="key">key</span>: <span class="string"><span class="content">&lt;secret key&gt;</span></span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_attach_secret_to_service_as_file_in_volume"><a class="anchor" href="#_attach_secret_to_service_as_file_in_volume"></a>Attach secret to service as file in volume</h5>
<div class="paragraph">
<p>To attach secret to service as file in volume, you need modify service volume spec and set <code>secret.name</code> to select secret and <code>secret.files</code> to select secret key value of should be used.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">kind</span>: <span class="string"><span class="content">Service</span></span>
<span class="key">version</span>: <span class="string"><span class="content">v1</span></span>
<span class="key">meta</span>:
  <span class="key">name</span>: <span class="string"><span class="content">2048</span></span>
  <span class="key">labels</span>:
    <span class="key">type</span>: <span class="string"><span class="content">proxy</span></span>
    <span class="key">demo</span>: <span class="string"><span class="content">test</span></span>
<span class="key">spec</span>:
  <span class="key">selector</span>:
    <span class="key">node</span>:
    <span class="key">labels</span>:
      <span class="key">type</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">example</span><span class="delimiter">&quot;</span></span>
  <span class="key">replicas</span>: <span class="string"><span class="content">1</span></span>
  <span class="key">network</span>:
    <span class="key">ports</span>: <span class="string"><span class="content">[&quot;80:8080/tcp&quot;]</span></span>
  <span class="key">template</span>:
    <span class="key">containers</span>:
    - <span class="string"><span class="content">name: nginx</span></span>
      <span class="key">image</span>:
        <span class="key">name</span>: <span class="string"><span class="content">evilroot/docker-2048</span></span>
      <span class="key">volume</span>:
      - <span class="string"><span class="content">name: &lt;volume name&gt;</span></span>
        <span class="key">path</span>: <span class="string"><span class="content">&lt;mount path&gt;</span></span>
    <span class="key">volumes</span>:
    - <span class="string"><span class="content">name: &lt;volume name&gt;</span></span>
      <span class="key">secret</span>:
        <span class="key">name</span>: <span class="string"><span class="content">&lt;secret name&gt;</span></span>
        <span class="key">files</span>: <span class="string"><span class="content">[&lt;secret key&gt;]</span></span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_update_secret"><a class="anchor" href="#_update_secret"></a>Update secret</h5>
<div class="paragraph">
<p>You can update secret by changing data but not secret type:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">$lb secret update &lt;namespace name&gt; &lt;name of auth secret&gt; -a -u &lt;username&gt; -p &lt;password&gt;
$lb secret update &lt;namespace name&gt; &lt;name of text secret&gt; -t &lt;key&gt;=&lt;value&gt; -t &lt;key2&gt;=&lt;value2&gt;
$lb secret update &lt;namespace name&gt; &lt;name of file secret&gt; -f &lt;file path&gt; -f &lt;file2 path&gt;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_remove_secret"><a class="anchor" href="#_remove_secret"></a>Remove secret</h5>
<div class="paragraph">
<p>You can update secret by changing data but not secret type:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">$lb secret remove &lt;namespace name&gt; &lt;name secret&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_config"><a class="anchor" href="#_config"></a>6.1.8. Config</h4>
<div class="paragraph">
<p>Configs is designed to store configuration information for your sercices.
If you need to use configs, you should attach it in to pod. There is 2 options how you can do it:
- attach config to pod as file placed in volume
- attach config value to pod environment</p>
</div>
<div class="sect4">
<h5 id="_get_configs"><a class="anchor" href="#_get_configs"></a>Get configs</h5>
<div class="paragraph">
<p>To receive config list in namespace use:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">$lb config ls &lt;namespace name&gt;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_inspect_config"><a class="anchor" href="#_inspect_config"></a>Inspect config</h5>
<div class="paragraph">
<p>To get config information use:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">$lb config inspect &lt;namespace name&gt; &lt;config name&gt;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_create_config"><a class="anchor" href="#_create_config"></a>Create config</h5>
<div class="paragraph">
<p>You can create config of 2 types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>text - config type designed to store key=value info.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>$lb config create &lt;namespace name&gt; &lt;name&gt; -t &lt;key&gt;=&lt;value&gt; -t &lt;key2&gt;=&lt;value2&gt;</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>file - config type designed to store config files, like config.yaml</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>$lb config create &lt;namespace name&gt; &lt;name&gt; -f &lt;file path&gt; -f &lt;file path&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>You can create config providing config manifest and apply it into namespace:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">$lb namespace apply &lt;namespace name&gt; -f &lt;config manifest file&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Exmaple of config manifest:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">kind</span>: <span class="string"><span class="content">Config</span></span>
<span class="key">version</span>: <span class="string"><span class="content">v1</span></span>
<span class="key">meta</span>:
  <span class="key">name</span>: <span class="string"><span class="content">lastbackend</span></span>
<span class="key">spec</span>:
  <span class="key">type</span>: <span class="string"><span class="content">file</span></span>
  <span class="key">data</span>:
  - <span class="string"><span class="content">key: config.yml</span></span>
    <span class="key">file</span>: <span class="string"><span class="content">./contrib/config.yml</span></span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_attach_config_to_service_as_environment_variable"><a class="anchor" href="#_attach_config_to_service_as_environment_variable"></a>Attach config to service as environment variable</h5>
<div class="paragraph">
<p>To attach config to environment variable in service, you need modify service container spec and set <code>env.config.name</code> to select config and <code>env.config.key</code> to select config key value of should be used.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">kind</span>: <span class="string"><span class="content">Service</span></span>
<span class="key">version</span>: <span class="string"><span class="content">v1</span></span>
<span class="key">meta</span>:
  <span class="key">name</span>: <span class="string"><span class="content">2048</span></span>
  <span class="key">labels</span>:
    <span class="key">type</span>: <span class="string"><span class="content">proxy</span></span>
    <span class="key">demo</span>: <span class="string"><span class="content">test</span></span>
<span class="key">spec</span>:
  <span class="key">selector</span>:
    <span class="key">node</span>:
    <span class="key">labels</span>:
      <span class="key">type</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">example</span><span class="delimiter">&quot;</span></span>
  <span class="key">replicas</span>: <span class="string"><span class="content">1</span></span>
  <span class="key">network</span>:
    <span class="key">ports</span>: <span class="string"><span class="content">[&quot;80:8080/tcp&quot;]</span></span>
  <span class="key">template</span>:
    <span class="key">containers</span>:
    - <span class="string"><span class="content">name: nginx</span></span>
      <span class="key">image</span>:
        <span class="key">name</span>: <span class="string"><span class="content">evilroot/docker-2048</span></span>
      <span class="key">env</span>:
        - <span class="string"><span class="content">name: &lt;env name&gt;</span></span>
          <span class="key">config</span>:
            <span class="key">name</span>: <span class="string"><span class="content">&lt;config name&gt;</span></span>
            <span class="key">key</span>: <span class="string"><span class="content">&lt;config key&gt;</span></span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_attach_config_to_service_as_file_in_volume"><a class="anchor" href="#_attach_config_to_service_as_file_in_volume"></a>Attach config to service as file in volume</h5>
<div class="paragraph">
<p>To attach config to service as file in volume, you need modify service volume spec and set <code>config.name</code> to select config and <code>config.files</code> to select config files which should be placed in volume.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">kind</span>: <span class="string"><span class="content">Service</span></span>
<span class="key">version</span>: <span class="string"><span class="content">v1</span></span>
<span class="key">meta</span>:
  <span class="key">name</span>: <span class="string"><span class="content">2048</span></span>
  <span class="key">labels</span>:
    <span class="key">type</span>: <span class="string"><span class="content">proxy</span></span>
    <span class="key">demo</span>: <span class="string"><span class="content">test</span></span>
<span class="key">spec</span>:
  <span class="key">selector</span>:
    <span class="key">node</span>:
    <span class="key">labels</span>:
      <span class="key">type</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">example</span><span class="delimiter">&quot;</span></span>
  <span class="key">replicas</span>: <span class="string"><span class="content">1</span></span>
  <span class="key">network</span>:
    <span class="key">ports</span>: <span class="string"><span class="content">[&quot;80:8080/tcp&quot;]</span></span>
  <span class="key">template</span>:
    <span class="key">containers</span>:
    - <span class="string"><span class="content">name: nginx</span></span>
      <span class="key">image</span>:
        <span class="key">name</span>: <span class="string"><span class="content">evilroot/docker-2048</span></span>
      <span class="key">volume</span>:
      - <span class="string"><span class="content">name: &lt;volume name&gt;</span></span>
        <span class="key">path</span>: <span class="string"><span class="content">&lt;mount path&gt;</span></span>
    <span class="key">volumes</span>:
    - <span class="string"><span class="content">name: &lt;volume name&gt;</span></span>
      <span class="key">config</span>:
        <span class="key">name</span>: <span class="string"><span class="content">&lt;config name&gt;</span></span>
        <span class="key">files</span>: <span class="string"><span class="content">[&lt;config key&gt;]</span></span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_update_config"><a class="anchor" href="#_update_config"></a>Update config</h5>
<div class="paragraph">
<p>You can update config by changing data but not config type:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">$lb config update &lt;namespace name&gt; &lt;name of text config&gt; -t &lt;key&gt;=&lt;value&gt; -t &lt;key2&gt;=&lt;value2&gt;
$lb config update &lt;namespace name&gt; &lt;name of file config&gt; -f &lt;file path&gt; -f &lt;file2 path&gt;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_remove_config"><a class="anchor" href="#_remove_config"></a>Remove config</h5>
<div class="paragraph">
<p>You can update config by changing data but not config type:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">$lb config remove &lt;namespace name&gt; &lt;name config&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_routes"><a class="anchor" href="#_routes"></a>6.1.9. Routes</h4>
<div class="paragraph">
<p>Routes are designed to pass external traffic into cluster network.
Route is a set of rules contains:
  - Domain - DNS record of route
  - Port - external port to listen
	- Rules: Set of rules for proxy:
    - Path to handle
    - Service service name to proxy
    - Service endpoint port to proxy</p>
</div>
<div class="sect4">
<h5 id="_get_routes"><a class="anchor" href="#_get_routes"></a>Get routes</h5>
<div class="paragraph">
<p>To receive routes list in namespace use:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">$lb route ls &lt;namespace name&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">$lb route ls demo

NAMESPACE  NAME  DOMAIN                HTTPS  STATUS
---------  ----  ------                -----  ------
demo       2048  2048.demo.lstbknd.io         initialized
demo       tank  tank.demo.lstbknd.io         initialized</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_inspect_route_info"><a class="anchor" href="#_inspect_route_info"></a>Inspect route info</h5>
<div class="paragraph">
<p>To get route information use:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">$lb route inspect &lt;namespace name&gt; &lt;route name&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">$lb route inspect demo 2048
NAME       2048
NAMESPACE  demo
DOMAIN     2048.demo.lstbknd.io
PORT       80
STATUS     initialized


PATH  SERVICE  ENDPOINT            PORT
----  -------  --------            ----
/     2048     2048.demo.lb.local  80</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_create_route"><a class="anchor" href="#_create_route"></a>Create route</h5>
<div class="paragraph">
<p>To create route you should provide domain and set of rules where ingress should proxy traffic</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">$lb route create &lt;namespace name&gt; &lt;route name&gt; -p &lt;route port&gt; &lt;service name&gt;:&lt;service port&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">$lb route create demo test -p 443 2048:80
PORT       443
STATUS     initialized
NAME       test
NAMESPACE  demo
DOMAIN     test.demo.lstbknd.io


PATH  SERVICE  ENDPOINT            PORT
----  -------  --------            ----
      2048     2048.demo.lb.local  80</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_update_route"><a class="anchor" href="#_update_route"></a>Update route</h5>
<div class="paragraph">
<p>You can anytime update your route, just passing new rules:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">$lb route update &lt;namespace name&gt; &lt;route name&gt; -p &lt;route port&gt; &lt;service name&gt;:&lt;service port&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">$lb route update demo test -p 80 tank:80
PORT       tank
STATUS     initialized
NAME       test
NAMESPACE  demo
DOMAIN     test.demo.lstbknd.io


PATH  SERVICE  ENDPOINT            PORT
----  -------  --------            ----
      tank     tank.demo.lb.local  80</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_remove_route"><a class="anchor" href="#_remove_route"></a>Remove route</h5>
<div class="paragraph">
<p>To remove route use remove command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">$lb route remove &lt;namespace name&gt; &lt;route name&gt;</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_cluster_runtime"><a class="anchor" href="#_cluster_runtime"></a>6.2. Cluster runtime</h3>
<div class="paragraph">
<p>Cluster runtime is physical resources runtime, contains:
- Cluster management
- Node management
- Discovery management
- Ingress management</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_database"><a class="anchor" href="#_database"></a>7. Database</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_interface"><a class="anchor" href="#_interface"></a>7.1. Interface</h3>
<div class="literalblock">
<div class="title">Ordered Object management (object selfline should be unique per cluster)</div>
<div class="content">
<pre> .Info - returns object runtime info
.Get - returns object information from storage
.List - returns List of Objects
.Map - returns Map of objects, where key is object selflink
.Put - puts new object into storage
.Set - updates object in storage
.Del - deletes object from storage
.Watch - watches for object changes. Can watch collection, or set of collections if parent.
.Key - returns key created interface for selflink generation
.Collection - returns all collections available to perform operations
.Filter - returns all available filters</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_mock"><a class="anchor" href="#_mock"></a>7.2. Mock</h3>
<div class="paragraph">
<p>Mock driver is designed to perform tests without database usage. It is in-memory database with all implemeted methods.</p>
</div>
</div>
<div class="sect2">
<h3 id="_etcd_v3"><a class="anchor" href="#_etcd_v3"></a>7.3. ETCD v3</h3>
<div class="paragraph">
<p>This version of Last.Backend uses ETCDv3 as default.</p>
</div>
<div class="paragraph">
<p><strong>Storage tree</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="generic">/lastbackend

namespace:
/lastbackend/namespace/&lt;namespace selflink&gt;: &lt;namespace object&gt;

service:
/lastbackend/service/&lt;service selflink&gt;: &lt;service object&gt;

endpoint:
/lastbackend/endpoint/&lt;endpoint selflink&gt;: &lt;endpoint object&gt;

deployment:
/lastbackend/deployment/&lt;deployment selflink&gt;: &lt;deployment object&gt;

pod:
/lastbackend/pod/&lt;pod selflink&gt;: &lt;pod object&gt;

volume:
/lastbackend/volume/&lt;volume selflink&gt;: &lt;volume object&gt;

secret:
/lastbackend/secret/&lt;secret selflink&gt;: &lt;secret object&gt;

config:
/lastbackend/config/&lt;config selflink&gt;: &lt;config object&gt;

route:
/lastbackend/route/&lt;route selflink&gt;: &lt;route object&gt;

discovery:
/lastbackend/discovery/&lt;discovery selflink&gt;/info: &lt;discovery object&gt;
/lastbackend/discovery/&lt;discovery selflink&gt;/status: &lt;discovery status object&gt;

ingress:
/lastbackend/ingress/&lt;ingress selflink&gt;/info: &lt;ingress object&gt;
/lastbackend/ingress/&lt;ingress selflink&gt;/status: &lt;ingress status object&gt;

cluster:
/lastbackend/cluster/info: &lt;cluster object&gt;

subnets:
/lastbackend/subnet/&lt;subnet cidr&gt;: &lt;subnet object&gt;

manifests:
/lastbackend/manifests/cluster/endpoint/&lt;endpoint selflink&gt;: &lt;endpoint manifest object&gt;
/lastbackend/manifests/cluster/subnet/&lt;subnet cidr&gt;: &lt;subnet manifest object&gt;

/lastbackend/manifest/node/&lt;node selflink&gt;/pod/&lt;pod selflink&gt;: &lt;pod manifest object&gt;
/lastbackend/manifest/node/&lt;node selflink&gt;/volume/&lt;volume selflink&gt;: &lt;volume manifest object&gt;

subnets:
/lastbackend/cluster/s/&lt;node hostname&gt;/meta: &lt;subnet meta object&gt;
/lastbackend/cluster/snet/&lt;node hostname&gt;/spec: &lt;subnet spec object&gt;

nodes:
/lastbackend/cluster/node/&lt;node selflink&gt;/info: &lt;node object&gt;
/lastbackend/cluster/node/&lt;node hostname&gt;/status: &lt;node status object&gt;

system:

/lastbackend/system
/lastbackend/system/ipam: &lt;IPAM state&gt;
/lastbackend/system/controller/&lt;controller selflink&gt;: &lt;controller object&gt;
/lastbackend/system/controller/&lt;controller selflink&gt;:lead: &lt;controller lead state&gt;</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_contributing"><a class="anchor" href="#_contributing"></a>8. Contributing</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_how_to_contribute"><a class="anchor" href="#_how_to_contribute"></a>8.1. How to Contribute</h3>
<div class="paragraph">
<p>The Last.Backend project is Apache 2.0 licensed and accepts contributions via GitHub pull requests.
This document outlines some of the conventions on commit message formatting, contact points for developers and other resources to make getting your contribution accepted.</p>
</div>
<div class="sect3">
<h4 id="_how_to_contribute_to_open_source_on_github"><a class="anchor" href="#_how_to_contribute_to_open_source_on_github"></a>8.1.1. How to contribute to open source on GitHub</h4>
<div class="paragraph">
<p>Please, read the <a href="https://guides.github.com/activities/contributing-to-open-source/">contributing to open source</a>, before contributing.</p>
</div>
</div>
<div class="sect3">
<h4 id="_benefits_for_active_contributors"><a class="anchor" href="#_benefits_for_active_contributors"></a>8.1.2. Benefits for active contributors</h4>
<div class="paragraph">
<p><strong>Limited free Last.Backend cloud resources</strong></p>
</div>
</div>
<div class="sect3">
<h4 id="_coding_style"><a class="anchor" href="#_coding_style"></a>8.1.3. Coding Style</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>All code should be formatted with <code>gofmt</code></p>
</li>
<li>
<p>All code should follow the guidelines covered in Effective Go and Go Code Review Comments.</p>
</li>
<li>
<p>Comment the code. Tell us the why, the history and the context.</p>
</li>
<li>
<p>Variable name length should not be too long.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Great materials to read:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://golang.org/doc/effective_go.html">Effective Go</a></p>
</li>
<li>
<p><a href="https://blog.golang.org">The Go Blog</a></p>
</li>
<li>
<p><a href="https://github.com/golang/go/wiki/CodeReviewComments">Code Review Comments</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Great tools to use:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/kisielk/errcheck">ErrCheck</a> - a program for checking for unchecked errors in Go programs.</p>
</li>
<li>
<p><a href="https://github.com/golang/lint">GoLint</a> - a linter for Go source code.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_reporting_issues"><a class="anchor" href="#_reporting_issues"></a>8.1.4. Reporting issues</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Tell us version of Last.Backend you use</p>
</li>
<li>
<p>Include the steps required to reproduce the problem, if possible</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_the_roadmap"><a class="anchor" href="#_the_roadmap"></a>8.2. The Roadmap</h3>
<div class="paragraph">
<p>The Last.Backend project roadmap lives in <a href="https://github.com/lastbackend/lastbackend/projects/5">github project</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_support"><a class="anchor" href="#_support"></a>8.3. Support</h3>
<div class="paragraph">
<p>While there are many different channels that you can use to get hold of us (Issues, Forums/Mailing lists),
you can help to make sure that we are efficient in getting you the help that you need.</p>
</div>
<div class="paragraph">
<p>Before opening a new issue, it&#8217;s helpful to search the project - it&#8217;s likely that another user has already reported the issue you&#8217;re facing,
or it&#8217;s a known issue that we&#8217;re already aware of.</p>
</div>
<div class="paragraph">
<p>If you need support, start with the troubleshooting guide and work your way through the process that we&#8217;ve outlined.</p>
</div>
<div class="paragraph">
<p>That said, if you have questions, reach out to us one way or another. We don&#8217;t bite!</p>
</div>
</div>
<div class="sect2">
<h3 id="_documentation"><a class="anchor" href="#_documentation"></a>8.4. Documentation</h3>
<div class="paragraph">
<p>Locally can be generated with:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">$ docker run --rm -v `pwd`/docs/:/documents/      \
    asciidoctor/docker-asciidoctor                \
    asciidoctor -D /documents/output/ index.adoc</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you have any questions about the <strong>Last.Backend</strong> usage or want to share some information with the <strong>Last.Backend</strong> community, please go to one of the following places:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="mailto:question@lastbackend.com">question@lastbackend.com</a></p>
</li>
<li>
<p><a href="https://twitter.com/LastBackend">twitter @ LastBackend</a></p>
</li>
<li>
<p><a href="https://www.facebook.com/lastbackend">facebook</a></p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_license"><a class="anchor" href="#_license"></a>Appendix A: License</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This project is licensed using the  <strong>Apache License Version 2.0</strong>.
For the full project license, see the <a href="https://github.com/lastbackend/lastbackend/blob/master/LICENSE">LICENSE</a> file.</p>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Version latest<br>
Last updated 2019-09-21 15:20:44 UTC
</div>
</div>
<style>
/* Stylesheet for CodeRay to match GitHub theme | MIT License | http://foundation.zurb.com */
pre.CodeRay{background:#f7f7f8}
.CodeRay .line-numbers{border-right:1px solid currentColor;opacity:.35;padding:0 .5em 0 0}
.CodeRay span.line-numbers{display:inline-block;margin-right:.75em}
.CodeRay .line-numbers strong{color:#000}
table.CodeRay{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.CodeRay td{vertical-align:top;line-height:inherit}
table.CodeRay td.line-numbers{text-align:right}
table.CodeRay td.code{padding:0 0 0 .75em}
.CodeRay .debug{color:#fff !important;background:#000080 !important}
.CodeRay .annotation{color:#007}
.CodeRay .attribute-name{color:#000080}
.CodeRay .attribute-value{color:#700}
.CodeRay .binary{color:#509}
.CodeRay .comment{color:#998;font-style:italic}
.CodeRay .char{color:#04d}
.CodeRay .char .content{color:#04d}
.CodeRay .char .delimiter{color:#039}
.CodeRay .class{color:#458;font-weight:bold}
.CodeRay .complex{color:#a08}
.CodeRay .constant,.CodeRay .predefined-constant{color:#008080}
.CodeRay .color{color:#099}
.CodeRay .class-variable{color:#369}
.CodeRay .decorator{color:#b0b}
.CodeRay .definition{color:#099}
.CodeRay .delimiter{color:#000}
.CodeRay .doc{color:#970}
.CodeRay .doctype{color:#34b}
.CodeRay .doc-string{color:#d42}
.CodeRay .escape{color:#666}
.CodeRay .entity{color:#800}
.CodeRay .error{color:#808}
.CodeRay .exception{color:inherit}
.CodeRay .filename{color:#099}
.CodeRay .function{color:#900;font-weight:bold}
.CodeRay .global-variable{color:#008080}
.CodeRay .hex{color:#058}
.CodeRay .integer,.CodeRay .float{color:#099}
.CodeRay .include{color:#555}
.CodeRay .inline{color:#000}
.CodeRay .inline .inline{background:#ccc}
.CodeRay .inline .inline .inline{background:#bbb}
.CodeRay .inline .inline-delimiter{color:#d14}
.CodeRay .inline-delimiter{color:#d14}
.CodeRay .important{color:#555;font-weight:bold}
.CodeRay .interpreted{color:#b2b}
.CodeRay .instance-variable{color:#008080}
.CodeRay .label{color:#970}
.CodeRay .local-variable{color:#963}
.CodeRay .octal{color:#40e}
.CodeRay .predefined{color:#369}
.CodeRay .preprocessor{color:#579}
.CodeRay .pseudo-class{color:#555}
.CodeRay .directive{font-weight:bold}
.CodeRay .type{font-weight:bold}
.CodeRay .predefined-type{color:inherit}
.CodeRay .reserved,.CodeRay .keyword {color:#000;font-weight:bold}
.CodeRay .key{color:#808}
.CodeRay .key .delimiter{color:#606}
.CodeRay .key .char{color:#80f}
.CodeRay .value{color:#088}
.CodeRay .regexp .delimiter{color:#808}
.CodeRay .regexp .content{color:#808}
.CodeRay .regexp .modifier{color:#808}
.CodeRay .regexp .char{color:#d14}
.CodeRay .regexp .function{color:#404;font-weight:bold}
.CodeRay .string{color:#d20}
.CodeRay .string .string .string{background:#ffd0d0}
.CodeRay .string .content{color:#d14}
.CodeRay .string .char{color:#d14}
.CodeRay .string .delimiter{color:#d14}
.CodeRay .shell{color:#d14}
.CodeRay .shell .delimiter{color:#d14}
.CodeRay .symbol{color:#990073}
.CodeRay .symbol .content{color:#a60}
.CodeRay .symbol .delimiter{color:#630}
.CodeRay .tag{color:#008080}
.CodeRay .tag-special{color:#d70}
.CodeRay .variable{color:#036}
.CodeRay .insert{background:#afa}
.CodeRay .delete{background:#faa}
.CodeRay .change{color:#aaf;background:#007}
.CodeRay .head{color:#f8f;background:#505}
.CodeRay .insert .insert{color:#080}
.CodeRay .delete .delete{color:#800}
.CodeRay .change .change{color:#66f}
.CodeRay .head .head{color:#f4f}
</style>
</body>
</html>